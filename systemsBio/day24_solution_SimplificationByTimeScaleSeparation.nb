(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    199480,       4519]
NotebookOptionsPosition[    182942,       4311]
NotebookOutlinePosition[    183930,       4342]
CellTagsIndexPosition[    183887,       4339]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Biological Modelling and Model Analysis - day XVI", "BookChapterLabel",
 CellChangeTimes->{{3.6829991255094852`*^9, 3.68299914575751*^9}, 
   3.682999421015033*^9, {3.683964417430398*^9, 3.6839644182337*^9}, {
   3.684211167243585*^9, 3.6842111677952013`*^9}, {3.6846008011508827`*^9, 
   3.684600802071863*^9}, {3.684600951496284*^9, 3.6846009519396544`*^9}, 
   3.747467470854506*^9, {3.844392055535904*^9, 
   3.844392056172394*^9}},ExpressionUUID->"712d05a1-22e9-40b4-b2c8-\
7bb14cf91ee6"],

Cell["Unravelling complex dynamics by a separation of time-scales", \
"BookChapterTitle",
 CellChangeTimes->{{3.682998874641573*^9, 3.682998895360573*^9}, {
  3.683964426788683*^9, 3.683964434866899*^9}, {3.6842111720763702`*^9, 
  3.684211179683154*^9}, {3.778819976759632*^9, 
  3.7788199903269167`*^9}},ExpressionUUID->"b0913eb0-414b-4b19-bee1-\
719825f7d76d"],

Cell[CellGroupData[{

Cell["Sander van Doorn", "Author",
 CellChangeTimes->{{3.68299919036697*^9, 3.6829991932712607`*^9}, {
   3.684211182529632*^9, 3.6842111910280933`*^9}, 
   3.844392051369215*^9},ExpressionUUID->"da5d9699-dcd8-4f6c-ab9a-\
437fb0c4c2f8"],

Cell["Groningen Institute for Evolutionary Life Sciences", "Institution",
 CellChangeTimes->{{3.6829992274406776`*^9, 
  3.6829992458415174`*^9}},ExpressionUUID->"2b0dfb21-823c-42d7-ab10-\
c8b796f19997"],

Cell["g.s.van.doorn@rug.nl", "Department",
 CellChangeTimes->{{3.68299926217015*^9, 
  3.6829992690098343`*^9}},ExpressionUUID->"9c52bd2c-b549-482c-9cf8-\
ac58f26ed6f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Model rescaling and non-dimensionalisation", "Section",
 CellChangeTimes->{{3.6829992928352165`*^9, 3.6829992962185545`*^9}, {
  3.684053399255887*^9, 3.6840534106583014`*^9}, {3.684654781552939*^9, 
  3.6846548024536753`*^9}, {3.6846563835799923`*^9, 
  3.684656406863645*^9}},ExpressionUUID->"1ec99daf-c380-4a7b-afdd-\
b2dea0c395c5"],

Cell[TextData[{
 "Consider the following model for bacteria (",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "cf114630-a113-4a25-9314-f0f7a28a0084"],
 ") growing in a chemostat. The variable ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "6671b227-8162-461f-b5ba-77e5ecaaa55e"],
 " represents the concentration of a growth limiting resource (e.g., a sugar) \
in the chemostat."
}], "Text",
 CellChangeTimes->{{3.68465859716885*^9, 3.684658622359797*^9}, {
  3.684658654870171*^9, 3.684658708004175*^9}, {3.6846587669053497`*^9, 
  3.6846588263192577`*^9}},ExpressionUUID->"0e1c88aa-cbb5-4959-ab81-\
63432d1be993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqS", "[", 
   RowBox[{"B_", ",", "S_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Phi]", 
    RowBox[{"(", 
     RowBox[{"S0", "-", "S"}], ")"}]}], "-", 
   RowBox[{"c", " ", "B", " ", 
    FractionBox["S", 
     RowBox[{"S", "+", "K"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqB", "[", 
   RowBox[{"B_", ",", "S_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c", " ", "\[Eta]", " ", "B", " ", 
    FractionBox["S", 
     RowBox[{"S", "+", "K"}]]}], "-", 
   RowBox[{"\[Phi]", " ", "B", " "}]}]}]}], "Input",
 CellChangeTimes->{{3.6846584439331093`*^9, 
  3.6846585772235813`*^9}},ExpressionUUID->"41fc4c02-0cd4-4c56-b7ac-\
5ba00f99e72e"],

Cell["The parameters of the model are: ", "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 
  3.6846590949340267`*^9}},ExpressionUUID->"a71f0dfd-33ce-44cf-a1a0-\
24219aa101e9"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]],ExpressionUUID->
  "57c2dad3-6a3d-40ec-a048-da88fe85212f"],
 "\tthe flow-rate of the chemostat; "
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.6846590958150053`*^9}, {3.684659169058609*^9, 
  3.684659169765613*^9}},ExpressionUUID->"af4bffdc-a776-4766-89dd-\
ba36d23bcfc2"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "0"], TraditionalForm]],ExpressionUUID->
  "4262d096-d6ed-470d-9559-99b2ae377612"],
 "\tthe concentration of the resource in the inflow medium; "
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659104201803*^9}, {3.68465917292271*^9, 
  3.684659173531711*^9}},ExpressionUUID->"7cca7de0-9e1b-45fc-bf88-\
8eb8092da686"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "805f81d1-a90c-47c8-9528-768a5bdf2f62"],
 "\tthe maximum consumption rate of the sugar by a bacterium; "
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.68465910790318*^9}, {3.6846591769065647`*^9, 
  3.684659177392416*^9}},ExpressionUUID->"bedd91ec-9653-4ec7-8c64-\
98d95e7d881b"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["K", TraditionalForm]],ExpressionUUID->
  "8f95dcce-17be-4502-a426-61b7ddbe24af"],
 "\tthe half-saturation constant of the functional response;"
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659125514151*^9}, {3.6846591807896643`*^9, 
  3.684659181222643*^9}},ExpressionUUID->"64de78e5-87e2-4466-bd7b-\
60d6f29cf647"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["\[Eta]", TraditionalForm]],ExpressionUUID->
  "d0e77fda-0caa-4383-9f36-ad4acd0442ea"],
 "\tthe conversion efficiency for bacterial growth on the available resource"
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
  3.684659225736107*^9}, {3.684659285224135*^9, 
  3.684659291106372*^9}},ExpressionUUID->"e646f763-cdfa-4b00-a656-\
9400cbe892d1"],

Cell["", "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
  3.684659225736107*^9}, {3.684659285224135*^9, 
  3.6846592911030188`*^9}},ExpressionUUID->"9e1229e9-57ff-4273-9b4e-\
7c8b590814ce"],

Cell[TextData[{
 StyleBox["Q1: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Choose appropriate units for the variables, and infer the \
dimensions of the model parameters",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
  3.684659225736107*^9}, {3.684659285224135*^9, 3.684659331451066*^9}, {
  3.684659368168975*^9, 
  3.684659402423229*^9}},ExpressionUUID->"f7fa8a6f-bc7b-4516-94b8-\
59ddc789e71b"],

Cell["\<\
There are different ways to choose units for the variables. If we stick to \
standard SI units, a suitable choice of units is: \
\>", "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.6846590949340267`*^9}, {3.810371287487179*^9, 
  3.810371298837228*^9}, {3.8103714344185553`*^9, 
  3.810371523007127*^9}},ExpressionUUID->"04ead36c-ed95-492a-ba36-\
ed6a67714b22"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],ExpressionUUID->
  "eb0bc43a-f6cd-4476-b5a2-210672c64812"],
 "\tnumber of cells per liter, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"#cells", " ", 
    SuperscriptBox["l", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "37559876-3227-4fc4-acf5-90bc083bec46"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.6846590958150053`*^9}, {3.684659169058609*^9, 
  3.684659169765613*^9}, {3.810371314142701*^9, 3.810371336262773*^9}, {
  3.810371387770509*^9, 3.81037138926012*^9}, {3.810371655877962*^9, 
  3.810371694354231*^9}},ExpressionUUID->"c324d0f6-2cf4-4a59-a838-\
cbbd5f23cee5"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],ExpressionUUID->
  "9c974ea6-c74c-4419-9b7a-b05aafd7dffd"],
 "\tmol per liter, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"mol", " ", 
    SuperscriptBox["l", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7a014f75-5452-4bf6-bbcc-00726e8ee79a"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659104201803*^9}, {3.68465917292271*^9, 
   3.684659173531711*^9}, {3.8103713188132687`*^9, 3.8103713853466997`*^9}, 
   3.8103714847418633`*^9, {3.8103716436063557`*^9, 3.810371652305368*^9}, 
   3.8103716877176113`*^9},ExpressionUUID->"df899873-5656-4fc6-bd13-\
3c980e94e591"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],ExpressionUUID->
  "38d5b384-dc77-45b8-afa4-6ffcafc5e636"],
 " (time)\tseconds, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c64538e5-258f-4266-b8a9-9e7f20d200a7"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659104201803*^9}, {3.68465917292271*^9, 
   3.684659173531711*^9}, {3.8103713188132687`*^9, 3.8103713853466997`*^9}, 
   3.8103714847418633`*^9, {3.810371576507798*^9, 3.810371592458456*^9}, {
   3.8103716346706457`*^9, 3.8103716380035563`*^9}, {3.810371689942408*^9, 
   3.810371690822241*^9}},ExpressionUUID->"d6394b8b-4b30-4629-a7fc-\
4afc5e8f69ca"],

Cell["\<\
Based on these choices, we can now derive the units for the parameters\
\>", "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
   3.684659225736107*^9}, {3.684659285224135*^9, 3.6846592911030188`*^9}, {
   3.810371417333714*^9, 3.810371428592235*^9}, {3.8103715349570007`*^9, 
   3.8103715500519247`*^9}, 
   3.810371600908445*^9},ExpressionUUID->"e632081d-d4cd-4a28-93b5-\
c249e631aa48"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]],ExpressionUUID->
  "840f0230-353a-4ce0-9bf9-9088a1766eda"],
 "\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6b8a9f7f-1c9b-4c50-87ed-67acec78555e"],
 " "
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.6846590958150053`*^9}, {3.684659169058609*^9, 
  3.684659169765613*^9}, {3.81037162582463*^9, 
  3.8103716320663843`*^9}},ExpressionUUID->"a5e2b8ed-3c35-4608-9b20-\
8bcd875035fc"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "0"], TraditionalForm]],ExpressionUUID->
  "16225322-a6e5-4607-9b9d-d52b618e20f4"],
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"mol", " ", 
    SuperscriptBox["l", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "5889dbeb-39dc-4630-a0be-065940b04dce"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659104201803*^9}, {3.68465917292271*^9, 
   3.684659173531711*^9}, 
   3.810371702488043*^9},ExpressionUUID->"28629f72-29d4-4755-b795-\
5c748733d13e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["c", TraditionalForm]],ExpressionUUID->
  "3007a6ed-c7b9-4212-abad-a2af7df2a613"],
 "\tmol ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "c049585b-f12e-4964-8db8-44cc5c8274e7"],
 " / #cells"
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.68465910790318*^9}, {3.6846591769065647`*^9, 
  3.684659177392416*^9}, {3.810371740154789*^9, 
  3.810371761752123*^9}},ExpressionUUID->"7607770a-f63c-404c-be26-\
64131123498e"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["K", TraditionalForm]],ExpressionUUID->
  "4ca668d3-eb7a-4f63-ac9e-8c0db794a021"],
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{"mol", " ", 
    SuperscriptBox["l", 
     RowBox[{"-", "1"}]]}], TraditionalForm]],ExpressionUUID->
  "81b517f8-0e3c-4d2c-b2c5-59583cac4347"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659125514151*^9}, {3.6846591807896643`*^9, 
   3.684659181222643*^9}, 
   3.8103717864837303`*^9},ExpressionUUID->"fdd4e481-da49-4460-b190-\
02ed05c25be2"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox["\[Eta]", TraditionalForm]],ExpressionUUID->
  "ce24d894-fa32-46c9-92ea-e8db19c61e7d"],
 "\t#cells / mol"
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
  3.684659225736107*^9}, {3.684659285224135*^9, 3.684659291106372*^9}, {
  3.810371797111225*^9, 
  3.810371805365526*^9}},ExpressionUUID->"b7cadd7b-d8c9-4631-b220-\
2b00eb568d8a"],

Cell["", "Text",ExpressionUUID->"6ec64139-e2fd-45b9-a5a9-7bda8819ae04"],

Cell[TextData[{
 StyleBox["Q2: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Eliminate parameters by rescaling the model. How many \
dimensionless parameters remain after rescaling? Give an interpretation for \
the rescaled variables and the dimensionless parameter combinations.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.684659139560313*^9}, {3.684659184309401*^9, 
  3.684659225736107*^9}, {3.684659285224135*^9, 3.684659331451066*^9}, {
  3.684659406009886*^9, 3.684659529593507*^9}, {3.684662944499014*^9, 
  3.68466296266722*^9}},ExpressionUUID->"1136663d-5092-4abc-8c04-\
f00b06f75a8c"],

Cell[TextData[{
 "Rescaling the model can be done in several ways. Here is one option that \
scales time relative to the dilution rate of the chemostat, ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ca085076-f7af-4442-9b85-a634e6b013a3"],
 " relative to the concentration of the resource in the inflow medium, and ",
 Cell[BoxData[
  FormBox["B", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "485202fe-9533-4a2c-9bd0-a26eea227988"],
 " relative to the number of bacterial cells that can be built from one unit \
of resource. After introducing rescaled variables and time, simplifying, and \
choosing values for the scaling factors, we end up with the following \
equations:"
}], "Text",
 CellChangeTimes->{{3.8103718659352093`*^9, 3.810372035318062*^9}, {
  3.810372708971477*^9, 
  3.810372796449938*^9}},ExpressionUUID->"5b519826-1e25-4fb8-bebf-\
3174133cae3c"],

Cell[TextData[Cell[BoxData[{
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", "x"}], 
    RowBox[{"d", " ", "\[Tau]"}]], "=", " ", 
   RowBox[{"1", "-", "x", "-", 
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", "\[Eta]"}], 
      RowBox[{"\[Phi]", " "}]], " ", "y", 
     FractionBox["x", 
      RowBox[{"x", " ", "+", 
       FractionBox["K", 
        SubscriptBox["S", "0"]]}]]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", "y"}], 
    RowBox[{"d", " ", "\[Tau]"}]], "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"c", " ", "\[Eta]"}], "\[Phi]"], "  ", "y", 
     FractionBox["x", 
      RowBox[{"x", "+", 
       FractionBox["K", 
        SubscriptBox["S", "0"]]}]]}], "-", "y"}]}], TraditionalForm]}],
 FormatType->
  "TraditionalForm",ExpressionUUID->"0d1840da-ca79-43d0-bb8e-6fa8905769e9"]], \
"Text",
 CellChangeTimes->{{3.810372051070986*^9, 3.8103721851393948`*^9}, {
  3.810372220792811*^9, 3.8103723340186663`*^9}, {3.8103723654435*^9, 
  3.810372369999935*^9}, {3.8103724195159903`*^9, 3.8103724244289923`*^9}, {
  3.8103724777524433`*^9, 3.810372556995607*^9}, {3.810372605159562*^9, 
  3.810372613989402*^9}, {3.8103726566321163`*^9, 
  3.8103726598547363`*^9}},ExpressionUUID->"84f9d75a-e85c-4970-8e84-\
9eaaf7be1776"],

Cell[TextData[{
 "with rescaled variables ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"S", " ", "/", " ", 
     SubscriptBox["S", "0"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6e3b9848-d0f7-437d-8465-deda2d9847c6"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", "=", 
    RowBox[{"B", "/", 
     RowBox[{"(", 
      RowBox[{"\[Eta]", " ", 
       SubscriptBox["S", "0"]}], ")"}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b728ff3b-a471-445d-ae23-d20ac8581810"],
 ",  and rescaled time ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Tau]", " ", "=", " ", 
    RowBox[{"t", " ", "\[Phi]"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "42732188-57f2-49f8-8a12-d4eada9798e6"],
 ". Now it can be seen that the model outcomes are determined by only two \
dimensionless combinations of parameters, i.e., "
}], "Text",
 CellChangeTimes->{{3.8103721875810843`*^9, 3.810372212376606*^9}, {
  3.810372449776314*^9, 3.810372459909473*^9}, {3.810372498552157*^9, 
  3.8103725038073587`*^9}, {3.810372646507904*^9, 3.8103726801390123`*^9}, {
  3.810372802111073*^9, 
  3.810372916711882*^9}},ExpressionUUID->"fc6d2448-6f06-456b-aacf-\
cf6f6a132293"],

Cell["", "Text",
 CellChangeTimes->{{3.8103721875810843`*^9, 3.810372212376606*^9}, {
  3.810372449776314*^9, 3.810372459909473*^9}, {3.810372498552157*^9, 
  3.8103725038073587`*^9}, {3.810372646507904*^9, 3.8103726801390123`*^9}, {
  3.810372802111073*^9, 
  3.810372916107477*^9}},ExpressionUUID->"9c8f7584-8ccf-43f6-9d2b-\
9e82fad49705"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"c", " ", "\[Eta]"}], 
     RowBox[{"\[Phi]", " "}]], "=", "\[Gamma]"}], TraditionalForm]],
  ExpressionUUID->"b6f72037-3b3d-45d7-b28e-9d308aa26924"],
 ",\t the scaled maximum consumption rate, and "
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
  3.684658903358938*^9, 3.6846590958150053`*^9}, {3.684659169058609*^9, 
  3.684659169765613*^9}, {3.81037162582463*^9, 3.8103716320663843`*^9}, {
  3.810372932785301*^9, 
  3.810372991960205*^9}},ExpressionUUID->"6a7a36c5-302b-4f4c-9354-\
1a9fbf0787d1"],

Cell[TextData[{
 "\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["K", 
     SubscriptBox["S", "0"]], "=", "\[Kappa]"}], TraditionalForm]],
  ExpressionUUID->"3bc65497-b280-4255-b65f-531f0c8d021e"],
 ",\tthe scaled half-saturation constant of the functional response"
}], "Text",
 CellChangeTimes->{{3.6846588332848797`*^9, 3.684658840671934*^9}, {
   3.684658903358938*^9, 3.684659104201803*^9}, {3.68465917292271*^9, 
   3.684659173531711*^9}, 3.810371702488043*^9, {3.810373000354314*^9, 
   3.810373024269349*^9}},ExpressionUUID->"b996609b-4426-499c-81c9-\
63b2774e916e"],

Cell["\<\
With these new (dimensionless) parameters, the model simplifies to:\
\>", "Text",
 CellChangeTimes->{{3.810373029678114*^9, 
  3.810373063916925*^9}},ExpressionUUID->"9214d177-0858-4494-9216-\
0eec310a6954"],

Cell[TextData[Cell[BoxData[{
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", "x"}], 
    RowBox[{"d", " ", "\[Tau]"}]], "=", " ", 
   RowBox[{"1", "-", "x", "-", 
    RowBox[{"\[Gamma]", " ", "y", 
     FractionBox["x", 
      RowBox[{"x", " ", "+", "\[Kappa]"}]]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", "y"}], 
    RowBox[{"d", " ", "\[Tau]"}]], "=", 
   RowBox[{
    RowBox[{"\[Gamma]", "  ", "y", 
     FractionBox["x", 
      RowBox[{"x", "+", "\[Kappa]"}]]}], "-", "y"}]}], TraditionalForm]}],
 FormatType->
  "TraditionalForm",ExpressionUUID->"b7e55b67-94e7-44fd-9e10-2617dd37a5c8"]], \
"Text",
 CellChangeTimes->{{3.810372051070986*^9, 3.8103721851393948`*^9}, {
  3.810372220792811*^9, 3.8103723340186663`*^9}, {3.8103723654435*^9, 
  3.810372369999935*^9}, {3.8103724195159903`*^9, 3.8103724244289923`*^9}, {
  3.8103724777524433`*^9, 3.810372556995607*^9}, {3.810372605159562*^9, 
  3.810372613989402*^9}, {3.8103726566321163`*^9, 3.8103726598547363`*^9}, {
  3.810373074470755*^9, 
  3.810373085133451*^9}},ExpressionUUID->"5a78d289-dcff-4a2c-893d-\
f891a35f606c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Bursting in pancreatic ",
 StyleBox["\[Beta]-",
  FontWeight->"Plain"],
 "cells"
}], "Section",
 CellChangeTimes->{{3.6829992928352165`*^9, 3.6829992962185545`*^9}, {
  3.684053399255887*^9, 3.6840534106583014`*^9}, {3.684473282880713*^9, 
  3.684473311320716*^9}},ExpressionUUID->"0ccdd211-acb5-42fe-9c9d-\
ca4bee80be22"],

Cell[CellGroupData[{

Cell["Model definition", "Subsection",
 CellChangeTimes->{{3.684214916377565*^9, 3.684214922037405*^9}, {
  3.684468534015853*^9, 
  3.684468538140348*^9}},ExpressionUUID->"e2e53a12-4243-4327-a052-\
da0b0400d252"],

Cell[TextData[{
 "Pancreatic \[Beta]-cells play a key role in the regulation of the blood \
glucose concentration. Their primary function is to produce, store and \
release the hormone insulin. \[Beta]-cells in an intact islet of Langerhans \
exhibit bursting electrical activity, i.e., they alternate between periods of \
spontaneous electrical spiking and a resting state without rapid electrical \
activity. This behaviour is thought to be regulated by the intracellular ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "4248c8c6-f1b6-4163-86c7-bfb956b1afe3"],
 "concentration. The electrical activity of \[Beta]-cells can be described by \
the following model, which was originally suggested by Catherine Morris and \
Harold Lecar (",
 StyleBox["Biophys. J.",
  FontSlant->"Italic"],
 " ",
 StyleBox["35",
  FontWeight->"Bold"],
 ": 193-213 (1981)): "
}], "Text",
 CellChangeTimes->{{3.683964776135131*^9, 3.683964967347437*^9}, {
  3.683965028754643*^9, 3.683965028756803*^9}, {3.684053425326909*^9, 
  3.684053430015729*^9}, {3.6844735038848763`*^9, 3.684473531205822*^9}, {
  3.684473567531537*^9, 3.684473593111326*^9}, {3.6844736686731377`*^9, 
  3.684473801574164*^9}, {3.6844738394887247`*^9, 3.6844738553815928`*^9}, {
  3.6844739289958677`*^9, 3.684474090154101*^9}, {3.684474123557878*^9, 
  3.6844742688821373`*^9}, {3.684474321977748*^9, 3.684474363239541*^9}, {
  3.684474442951288*^9, 3.684474517896854*^9}, {3.684474592697666*^9, 
  3.684474594104718*^9}},ExpressionUUID->"a9803371-c5fc-4685-9fbe-\
8e0e6ad82ffe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqV", "[", 
   RowBox[{"V_", ",", "W_", ",", "Ca_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"J", "-", 
     RowBox[{
      SubscriptBox["g", "ca"], 
      RowBox[{
       SubscriptBox["m", "\[Infinity]"], "[", "V", "]"}], 
      RowBox[{"(", 
       RowBox[{"V", "-", 
        SubscriptBox["v", "ca"]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["g", "k"], "W"}], "+", 
        RowBox[{
         SubscriptBox["g", "kca"], " ", 
         RowBox[{"z", "[", "Ca", "]"}]}]}], " ", ")"}], 
      RowBox[{"(", 
       RowBox[{"V", "-", 
        SubscriptBox["v", "K"]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["g", "l"], 
      RowBox[{"(", 
       RowBox[{"V", "-", 
        SubscriptBox["v", "l"]}], ")"}]}]}], ")"}], "/", 
   "Cm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqW", "[", 
   RowBox[{"V_", ",", "W_"}], "]"}], ":=", 
  RowBox[{"0.23", "  ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["w", "\[Infinity]"], "[", "V", "]"}], "-", "W"}], ")"}], 
    "/", 
    RowBox[{"\[Tau]", "[", "V", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.684211221795672*^9, 3.684211235639113*^9}, {
   3.6842113109038143`*^9, 3.684211341000008*^9}, {3.684211445345533*^9, 
   3.684211502342806*^9}, {3.684211684581571*^9, 3.684211696496876*^9}, {
   3.6842166251962357`*^9, 3.684216659308909*^9}, {3.684217595939378*^9, 
   3.68421761189119*^9}, {3.6842177020487328`*^9, 3.684217727930935*^9}, {
   3.684222407069105*^9, 3.684222415410874*^9}, {3.68422251432663*^9, 
   3.684222535034788*^9}, 3.684222758145708*^9, {3.684463574572156*^9, 
   3.684463609199415*^9}, {3.6844636518464937`*^9, 3.6844636638734093`*^9}, {
   3.684463727459634*^9, 3.684463827107873*^9}, {3.684463862116486*^9, 
   3.6844638672457647`*^9}, {3.6844642289874897`*^9, 3.684464295908208*^9}, {
   3.684464385818719*^9, 3.684464454265895*^9}, {3.684464499275956*^9, 
   3.6844645014445963`*^9}, {3.684464660824621*^9, 3.684464671575164*^9}, {
   3.684464791516897*^9, 3.6844647940466423`*^9}, {3.684464862501449*^9, 
   3.6844648762388077`*^9}, {3.684465261821595*^9, 3.6844652629919767`*^9}, {
   3.6844653193236713`*^9, 3.6844653226568823`*^9}, {3.684467433134385*^9, 
   3.684467500907234*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"81fa9038-5744-4eba-85c7-99797297fded"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["m", "\[Infinity]"], "[", "V_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Tanh", "[", 
      FractionBox[
       RowBox[{"V", "+", "1.2"}], "18."], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["w", "\[Infinity]"], "[", "V_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", "2"], 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Tanh", "[", 
      FractionBox[
       RowBox[{"V", "-", "12."}], "17.4"], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "[", "Ca_", "]"}], ":=", 
  FractionBox["Ca", 
   RowBox[{"10.", "+", "Ca"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "[", "V_", "]"}], ":=", 
  RowBox[{"1", "/", 
   RowBox[{"Cosh", "[", 
    FractionBox[
     RowBox[{"V", "-", "12."}], "34.8"], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.684464537191059*^9, 3.684464688306467*^9}, {
   3.6844647327608767`*^9, 3.684464759173326*^9}, 3.684465410448698*^9, {
   3.6844663569010363`*^9, 3.6844663575755444`*^9}, {3.684466699872879*^9, 
   3.684466700787528*^9}, {3.684467183004201*^9, 3.684467184684743*^9}, 
   3.684467588100091*^9, {3.684467821616213*^9, 3.6844678217106647`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"fbf92283-127f-4bcf-b903-b16f958e984a"],

Cell[BoxData[
 RowBox[{"pars", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SubscriptBox["g", "ca"], "\[Rule]", "4."}], ",", " ", 
    RowBox[{
     SubscriptBox["v", "ca"], "\[Rule]", "120."}], ",", 
    RowBox[{
     SubscriptBox["g", "k"], "\[Rule]", "8."}], ",", 
    RowBox[{
     SubscriptBox["g", "kca"], " ", "\[Rule]", " ", ".25"}], ",", 
    RowBox[{
     SubscriptBox["v", "K"], "\[Rule]", 
     RowBox[{"-", "84."}]}], ",", 
    RowBox[{
     SubscriptBox["g", "l"], "\[Rule]", " ", "2."}], ",", 
    RowBox[{
     SubscriptBox["v", "l"], "\[Rule]", 
     RowBox[{"-", "60."}]}], ",", 
    RowBox[{"J", "\[Rule]", "45."}], ",", 
    RowBox[{"Cm", "\[Rule]", "20.0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.684464838410509*^9, 3.6844648403242283`*^9}, {
  3.6844648936768208`*^9, 3.6844649956422377`*^9}, {3.684465332158963*^9, 
  3.684465338513474*^9}, {3.6844654437219067`*^9, 3.684465444125927*^9}, {
  3.6844663117700653`*^9, 3.684466320060635*^9}, {3.684467679301217*^9, 
  3.684467692449098*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"46b9cbc7-372c-4504-b2a4-f1a3eb07612a"],

Cell[TextData[{
 "You will perhaps recognise that the structure of the model is similar to \
the Hodgkin-Huxley model. The first equation describes the change of the \
membrane potential (",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "434f5e6f-e2d3-49e3-b1fc-7052a39efb45"],
 ") as a consequence of four currents: an external stimulus current ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]],ExpressionUUID->
  "a18600df-6ec8-47f9-89fd-a1a3de1db467"],
 ", a voltage-dependent ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "b7367f90-58e8-4a0f-8053-a1394a0fa364"],
 "current, a voltage-dependent ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["K",
     FontSlant->"Plain"], "+"], TraditionalForm]],ExpressionUUID->
  "6663209c-4681-41ba-a44f-94acb409cbb7"],
 "current, and a leak current. The conductivity of the membrane for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["K",
     FontSlant->"Plain"], "+"], TraditionalForm]],ExpressionUUID->
  "fb9a648d-a3fb-4fcc-9711-f130573e0bef"],
 " is captured by the gating variable ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "cb93ad88-8aac-46ac-a77f-700abb4645a9"],
 ", which changes on a fast time scale according to the second equation. Some \
of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["K",
     FontSlant->"Plain"], "+"], TraditionalForm]],ExpressionUUID->
  "cd04baa4-cd7f-49c5-a3d5-18825916157e"],
 "channels are sensitive to the intracellular ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "9dc7e081-6747-4dd1-9f99-68b384524fe3"],
 "concentration, so the model includes a calcium-dependent contribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["g", "kca"], 
    RowBox[{"z", "[", "Ca", "]"}]}], TraditionalForm]],ExpressionUUID->
  "ba701612-e397-411c-a372-7ea7ad27f813"],
 " to the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    StyleBox["K",
     FontSlant->"Plain"], "+"], TraditionalForm]],ExpressionUUID->
  "c3a5941b-e7a0-4463-847d-a44ec2c788e8"],
 "conductivity. The parameters ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "ca"], TraditionalForm]],ExpressionUUID->
  "f9e4487a-4b8f-4d2e-b6d7-4aba3f9592c5"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "k"], TraditionalForm]],ExpressionUUID->
  "43bf6031-aa43-451b-9bba-d0d79954870f"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "kca"], TraditionalForm]],ExpressionUUID->
  "f8c04dda-1c5d-4f2d-9a8b-b651f73152a5"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "l"], TraditionalForm]],ExpressionUUID->
  "e89221eb-1779-497e-8858-dc614057b5a0"],
 " correspond to the maximum conductances for each respective current \
component and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "ca"], TraditionalForm]],ExpressionUUID->
  "9d16eedb-e235-4f59-932a-dce3e7d68774"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "k"], TraditionalForm]],ExpressionUUID->
  "7408e2da-1724-4491-a2a3-27a88aa74edf"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "l"], TraditionalForm]],ExpressionUUID->
  "611c88f8-96bd-483e-8a35-6f25e2b2b1f9"],
 " are the equilibrium membrane potentials for the calcium, potassium and \
leak currents in isolation. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "m"], TraditionalForm]],ExpressionUUID->
  "3918766d-145a-4211-9d61-ca1191f6c26d"],
 " is the membrane capacitance. The functions ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "\[Infinity]"], TraditionalForm]],ExpressionUUID->
  "b7601e55-877a-491a-8f13-44b4a0ca56ec"],
 ",  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["w", "\[Infinity]"], TraditionalForm]],ExpressionUUID->
  "f07e52a1-516c-4e7e-9932-9fd3ce354011"],
 " and \[Tau] were fitted to data from patch-clamp and biochemical \
experiments."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/S+I5e2soteOJnKvWWYDaU61GTwgerc5hOYq0zI7
BqRvNRwA0y8C/gRPLn7tKDEtLRxERzF9jAbRf/qV40F0RNfUDBDdG29UCaIX
LX5fC6KZzN7Ug2i1e/KdIDr1nctcEK18q3AhiK6wmrMZRG/ztN8FooNWpe8H
0V8K4k6CaPbNey6BaI9gsTsg+lakM5g2qtj2AkTPVQh5A6L3zQv+AKL5mKpZ
pgDpV8xsciB61aWT2iA6J+qZGYieL/DIAURfkYhyB9G5IVt9QPSOO48CQbTD
uQUhIHrnh4cRILrF2yQBTGtL5YLos2mnm0D0jReX+kC0H6fWYRANANn7rus=

  "],ExpressionUUID->"3d2cbfb5-5de3-41b4-bd0d-9edb8b9d3350"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibria and their stability", "Subsection",
 CellChangeTimes->{{3.684214916377565*^9, 3.684214922037405*^9}, {
  3.684468534015853*^9, 3.6844685558940687`*^9}, {3.684468651423153*^9, 
  3.6844686521482*^9}},ExpressionUUID->"bd19d4c6-0dfe-42da-87cb-15fa944b5aab"],

Cell[TextData[{
 "The model has complicated non-linear terms, so it is not possible to obtain \
explicit solution for the equilibria. However, we can solve for the \
equilibrium value of ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]],ExpressionUUID->
  "b006fb31-25d7-4239-be9a-db2b66bd9a55"],
 "..."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/S+I5e2soteOJnKvWWYDaU61GTwgerc5hOYq0zI7
BqRvNRwA0y8C/gRPLn7tKDEtLRxERzF9jAbRf/qV40F0RNfUDBDdG29UCaIX
LX5fC6KZzN7Ug2i1e/KdIDr1nctcEK18q3AhiK6wmrMZRG/ztN8FooNWpe8H
0V8K4k6CaPbNey6BaI9gsTsg+lakM5g2qtj2AkTPVQh5A6L3zQv+AKL5mKpZ
pgDpV8xsciB61aWT2iA6J+qZGYieL/DIAURfkYhyB9G5IVt9QPSOO48CQbTD
uQUhIHrnh4cRILrF2yQBTGtL5YLos2mnm0D0jReX+kC0H6fWYRD9ouze3KlA
ekEh72oQ3cYsuBFEX2DIAtMA2sC/lQ==
  "],ExpressionUUID->"22c8e69a-6f0c-4d53-8520-6bcf4eea598b"],

Cell[BoxData[
 RowBox[{"solW", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"eqW", "[", 
       RowBox[{"V", ",", "W"}], "]"}], "\[Equal]", "0"}], ",", "W"}], "]"}], "//",
    "First"}]}]], "Input",
 CellChangeTimes->{{3.684211523430284*^9, 3.684211563136348*^9}, {
  3.6842118679493237`*^9, 3.684211870489229*^9}, {3.6842166630830593`*^9, 
  3.684216674125532*^9}, {3.684464782431595*^9, 3.684464806172245*^9}, {
  3.684465002831991*^9, 3.684465013502646*^9}, {3.684465186178749*^9, 
  3.684465190610948*^9}, {3.6844652402346287`*^9, 3.68446524553839*^9}, {
  3.68446555979841*^9, 3.684465560355932*^9}, {3.6844656816024*^9, 
  3.684465765251554*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"a52a710c-8c75-4a5c-8b2d-0293671ba3c8"],

Cell[TextData[{
 "... and use this result to plot the equilibrium values of ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "c84a348f-09c6-4fd6-8a25-392e11924faa"],
 " as a function of the intracellular  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "5a45e24b-b9a6-40da-a0ee-5780280bad36"],
 "concentration."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/S+I5e2soteOJnKvWWYDaU61GTwgerc5hOYq0zI7
BqRvNRwA0y8C/gRPLn7tKDEtLRxERzF9jAbRf/qV40F0RNfUDBDdG29UCaIX
LX5fC6KZzN7Ug2i1e/KdIDr1nctcEK18q3AhiK6wmrMZRG/ztN8FooNWpe8H
0V8K4k6CaPbNey6BaI9gsTsg+lakM5g2qtj2AkTPVQh5A6L3zQv+AKL5mKpZ
pgDpV8xsciB61aWT2iA6J+qZGYieL/DIAURfkYhyB9G5IVt9QPSOO48CQbTD
uQUhIHrnh4cRILrF2yQBTGtL5YLos2mnm0D0jReX+kC0H6fWYRD9ouze3KlA
ekEh72oQ3cYsuBFEn1D7vgtEAwDfBcBJ
  "],ExpressionUUID->"79dce08f-eeab-4135-a57e-8f96ac02dc56"],

Cell[BoxData[
 RowBox[{"equilibria", "=", 
  RowBox[{"ContourPlot", "[", 
   RowBox[{
    RowBox[{"0", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"eqV", "[", 
         RowBox[{"V", ",", "W", ",", "Ca"}], "]"}], "/.", "solW"}], "/.", 
       "pars"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"Ca", ",", "0", ",", "20"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"V", ",", 
      RowBox[{"-", "40"}], ",", "20"}], "}"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", 
    RowBox[{"ContourStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<[Ca]\>\"", ",", "\"\<V\>\""}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684465779062523*^9, 3.684465863032241*^9}, {
  3.68446596001934*^9, 3.684465964382833*^9}, {3.684466159100485*^9, 
  3.684466159483479*^9}, {3.684466369127035*^9, 3.684466369621119*^9}, {
  3.6844671982108994`*^9, 3.684467202202531*^9}, {3.684468301284705*^9, 
  3.684468304381818*^9}, {3.684468577658235*^9, 3.684468611896041*^9}, {
  3.684468662401547*^9, 3.684468689199431*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"3ffc87ee-746e-4eb7-a1ae-490ca4606f09"],

Cell[TextData[{
 "As you can see, there is a single equilibrium for low ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "a4572cfc-4bdf-46a7-b9bc-024a001c0fdc"],
 "concentrations. Two additional equilibria appear at high ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "fd86633e-df69-4aec-a520-5c5178b36bed"],
 "concentrations."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ/S+I5e2soteOJnKvWWYDaU61GTwgerc5hOYq0zI7
BqRvNRwA0y8C/gRPLn7tKDEtLRxERzF9jAbRf/qV40F0RNfUDBDdG29UCaIX
LX5fC6KZzN7Ug2i1e/KdIDr1nctcEK18q3AhiK6wmrMZRG/ztN8FooNWpe8H
0V8K4k6CaPbNey6BaI9gsTsg+lakM5g2qtj2AkTPVQh5A6L3zQv+AKL5mKpZ
pgDpV8xsciB61aWT2iA6J+qZGYieL/DIAURfkYhyB9G5IVt9QPSOO48CQbTD
uQUhIHrnh4cRILrF2yQBTGtL5YLos2mnm0D0jReX+kC0H6fWYRD9ouze3KlA
ekEh72oQ3cYsuBFEn1D7vgtE61muOw6io44duAyiAS23yUE=
  "],ExpressionUUID->"cc737d2a-ffd4-47dd-a80a-a44bfef8f68c"],

Cell["\<\
Use the following procedure to determine the stability of the equilibria:\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwlxUEoQwEABuD19qIJcdE4DK122MphrYmLrSlEmvdemadMauNgMdNMEkmK
woFJeAy3KaVlMQulsMRhOWitlRW9vGFKuSx5/3P4+qr7higHIZPJykX4lyLf
N0YEs0ElkJviCs16IT6r/b/AqzVeiyemL6V5a45e8Qhm5ZqzE7PEVzfOLavt
2LbgH8CLdv043tv/nMSEMTOFNanKeez4aOSwOuHexb76rRAOtzREMBXsv8Df
wz0xnB+KxnEzXZbEiS6LtN4X5jFXxWTw+TadxcXEBLkq/ibPU+FgPKbDg+yr
Ee+UpE34Uck2YRdz3IZPkukObHoIMPg0+2zDs62GXmldhQvfO+9m8BMfX8Lt
Cu0V5r0pzi8ecBcd4Dl56RG+1fxEcE3d4Q2OWh1JTFnGXrDPM8rjPwIg0Xw=

  "],ExpressionUUID->"04154973-2baf-43ac-bf85-ebb54788aea9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"stabilityAnalysis", "[", "Ca_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eql", ",", "eqi", ",", "J"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"NSolve", "::", "ratnz"}], "MessageName"], 
      StyleBox["]", "MessageName"]}], 
     StyleBox[";", "MessageName"], 
     RowBox[{"eql", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"eqV", "[", 
             RowBox[{"V", ",", "W", ",", "Ca"}], "]"}], "\[Equal]", "0.0"}], 
           ",", 
           RowBox[{
            RowBox[{"eqW", "[", 
             RowBox[{"V", ",", "W"}], "]"}], "\[Equal]", "0.0"}]}], "}"}], "/.",
          "pars"}], ",", 
        RowBox[{"{", 
         RowBox[{"V", ",", "W"}], "}"}], ",", "Reals"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Number of equilibria: \>\"", ",", " ", 
       RowBox[{"Length", "[", "eql", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"stability", " ", "analysis"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"J", " ", "=", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eqV", "[", 
            RowBox[{"V", ",", "W", ",", "Ca"}], "]"}], ",", 
           RowBox[{"eqW", "[", 
            RowBox[{"V", ",", "W"}], "]"}]}], "}"}], "/.", "pars"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"V", ",", "W"}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"eqi", "=", 
         RowBox[{"eql", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<equilibrium \>\"", ",", " ", "i", ",", " ", "\"\<: \>\"", ",", 
          " ", "eqi"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<   eigenvalues: \>\"", ",", 
          RowBox[{
           RowBox[{"J", "/.", "eqi"}], "//", "Eigenvalues"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", " ", 
         RowBox[{"Length", "[", "eql", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.684472437988826*^9, 3.68447252223341*^9}, {
  3.6844725545090723`*^9, 3.684472821035384*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"ca95aed6-c14c-4d36-85a0-dc88d2ffa2d1"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "15.0", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
  3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
  3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
  3.684479793595368*^9, 3.684479794714405*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"40e5fffd-6cce-4ae1-9e2b-a2057a5a6496"],

Cell[TextData[{
 StyleBox["Q3: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Determine the stability and type (node, saddle or spiral) of the \
three equilibria that occur at ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "15"}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"a70a120f-a51b-4fd4-be1a-27fbdffbdb6d"],
 StyleBox[". ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.810373180576393*^9, 
  3.810373181918153*^9}},ExpressionUUID->"8a6134ee-20dc-4811-8999-\
697322d0d255"],

Cell["\<\
equilibrium 1: stable node; equilibrium 2: saddle (unstable); equilibrium 3: \
unstable spiral\
\>", "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479282930292*^9}, {3.8103731612741833`*^9, 
   3.810373213472003*^9}},ExpressionUUID->"f9b9b60a-5190-46a3-b414-\
ec443ceeb5d7"],

Cell[TextData[{
 StyleBox["Q4: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Use the procedure ",
  FontWeight->"Bold"],
 StyleBox["stabilityAnalysis[] ", "Input"],
 StyleBox["to investigate the sudden appearance of the lower two equilibria \
between ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "5.801"}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"717b5412-3d10-4062-bbcf-751b7a4f4d9d"],
 StyleBox[" and ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "5.802"}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"042d3aa0-f76d-45ce-bd87-eebf0f5a234b"],
 StyleBox[". Which bifurcation occurs here?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479330381472*^9}, {3.6844793822005653`*^9, 3.684479431914246*^9}, {
   3.6844794879879293`*^9, 3.6844794923149776`*^9}, {3.684479523138383*^9, 
   3.684479656599291*^9}, {3.684479978946348*^9, 3.6844799832385683`*^9}, {
   3.778820065435638*^9, 
   3.77882006570242*^9}},ExpressionUUID->"bc70e212-4c22-4d79-8cff-\
4e6ff666582f"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "5.801", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
  3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
  3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
  3.684479793595368*^9, 3.684479794714405*^9}, {3.810373290492736*^9, 
  3.810373294350902*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"52fd9de7-de58-4efd-ab03-a58f3eec38e8"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "5.802", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
  3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
  3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
  3.684479793595368*^9, 3.684479794714405*^9}, {3.810373290492736*^9, 
  3.810373317549736*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"2c39e535-14b1-4565-af9e-5105117ea28f"],

Cell[TextData[{
 "The bifurcation is a fold bifurcation: the equilibria at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", " ", "\[TildeTilde]", " ", 
    RowBox[{"-", "28.86"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "eca7e3d1-1538-47d0-9868-06b34e3f35cd"],
 " appear seemingly out of nothing, and both have one eigenvalue very close \
to zero."
}], "Text",
 CellChangeTimes->{{3.810373333400043*^9, 3.810373371045989*^9}, {
  3.810373406854423*^9, 
  3.8103734681680403`*^9}},ExpressionUUID->"e993298b-4a9b-456a-be46-\
2554551069d3"],

Cell[TextData[{
 StyleBox["Q5: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Now focus on the upper equilibrium and verify that it undergoes a \
Hopf bifurcation. Locate the exact position of the bifurcation point. ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479330381472*^9}, {3.6844793822005653`*^9, 3.684479431914246*^9}, {
   3.6844794879879293`*^9, 3.6844794923149776`*^9}, {3.684479523138383*^9, 
   3.684479656599291*^9}, {3.684479756955843*^9, 3.684479774846922*^9}, {
   3.684479877481009*^9, 3.684479896898038*^9}, {3.6844799899413433`*^9, 
   3.6844800178306713`*^9}, {3.684480320465049*^9, 3.684480320483506*^9}, {
   3.778820070523456*^9, 
   3.7788200706313066`*^9}},ExpressionUUID->"fcb4adbb-5e95-4111-bbd8-\
a4697d92b0e6"],

Cell[TextData[{
 "The bifurcation occurs between ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", " ", "=", " ", "9.26"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ef90018e-bb1c-4004-81aa-c863dac6fdd8"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", " ", "=", " ", "9.27"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "50e26968-bdd2-44d5-9348-53bcee388636"],
 ", as can be verified by inspecting the sign of the real part of the complex \
eigenvalue pair for equilibrium #3:"
}], "Text",
 CellChangeTimes->{{3.810373639452671*^9, 
  3.810373741223185*^9}},ExpressionUUID->"84a05020-8f8b-4c0a-b7e1-\
738e99676023"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "9.26", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
  3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
  3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
  3.684479793595368*^9, 3.684479794714405*^9}, {3.810373290492736*^9, 
  3.810373317549736*^9}, {3.81037351475944*^9, 3.810373568311296*^9}, {
  3.810373604131915*^9, 3.810373622832699*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"35a4de09-c384-407d-b640-3b2c54770bd7"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "9.27", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
  3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
  3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
  3.684479793595368*^9, 3.684479794714405*^9}, {3.810373290492736*^9, 
  3.810373317549736*^9}, {3.81037351475944*^9, 3.81037353703407*^9}, {
  3.8103735715215693`*^9, 3.8103736267916183`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"ab8d7851-cad4-4120-aa61-6e1181b8f303"],

Cell[TextData[StyleBox["",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479330381472*^9}, {3.6844793822005653`*^9, 3.684479431914246*^9}, {
   3.6844794879879293`*^9, 3.6844794923149776`*^9}, {3.684479523138383*^9, 
   3.684479656599291*^9}, {3.684479756955843*^9, 3.684479774846922*^9}, {
   3.684479877481009*^9, 3.684479896898038*^9}, {3.6844799899413433`*^9, 
   3.6844800178306713`*^9}, {3.684480320465049*^9, 
   3.6844803230382023`*^9}},ExpressionUUID->"dc37668f-08e0-4abe-9914-\
83e6430fdb13"],

Cell[TextData[{
 StyleBox["Q6: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Copy the above plot of the equilibrium values on a piece of paper, \
but use different line styles to distinguish between stable and unstable \
equilibria (e.g., use a dashed line for the unstable equilibria). Also \
indicate the position of the bifurcation points.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479330381472*^9}, {3.6844793822005653`*^9, 3.684479431914246*^9}, {
   3.6844794879879293`*^9, 3.6844794923149776`*^9}, {3.684479523138383*^9, 
   3.684479656599291*^9}, {3.684479756955843*^9, 3.684479774846922*^9}, {
   3.684479877481009*^9, 3.684479896898038*^9}, {3.6844799899413433`*^9, 
   3.6844800178306713`*^9}, {3.684480320465049*^9, 3.68448033548237*^9}, {
   3.684480506396783*^9, 3.6844805713733177`*^9}, {3.684480620976695*^9, 
   3.6844808009389753`*^9}, {3.7788200745928593`*^9, 
   3.778820074721466*^9}},ExpressionUUID->"db8cd0e2-59d1-44d5-8ed3-\
4b0bd88a6afb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["A stable periodic solution", "Subsection",
 CellChangeTimes->{{3.684480939473117*^9, 3.684480944495893*^9}, {
  3.684491502980364*^9, 
  3.68449150830857*^9}},ExpressionUUID->"3b3a750d-5eed-4ae9-b37c-\
46435bf90c42"],

Cell["\<\
Hopf bifurcations give rise to limit cycles, which can be either stable or \
unstable. To find out which cycles appear in the model, we solve the model \
numerically and show the trajectories in a phaseportrait with null-clines and \
vector field.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwlxU8oQ3EAB/D1tmhCXDQO82e1w1YOaz1xsUUhEttinjKpjYPFptYkkaQo
HNgIj+E2pbQsRqzUWLLDOLDWyg562TCl7DDy+87h06dyYERjpHg8XimBfzWC
tw1rQq0UJwSbZKF0PR+f1fyfZ5PRAXJk2p+d68hoV8YSapHT1I0Z6rMXZ5Yl
BqxfcAzhRYNiHO/tf0xiik5OYWmsfB4b3xtZLIlYdrG9bsuDvS31PqxxD17i
r9G+IM71nIdxs7YkiiM9DdkVdi+H2QpdEl9sa1O4kJoQrJJf+Tli7A4H5XiY
eaHxTlFchR9ETBM2647b8Ek03olVIZcOn6ae9Xi2VdmfXV5mxnem2xn8yIWX
cLtQdoU5W4x1kF2WggM8xy8+wjfSbx+urj28xkzAf4+fQl1pJ9n6k65aI/8B
HUHTKw==
  "],ExpressionUUID->"6c86bc52-fdee-4c92-830d-7ace09dc1bee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"phasePortrait", "[", 
   RowBox[{"Ca_", ",", 
    RowBox[{"initialConditions_List", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eql", ",", "fixedPoints", ",", "nullClines", ",", "vectorField", ",", 
      "sys", ",", "vars", ",", "tEnd", ",", "init", ",", "solution", ",", 
      "trajectories"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"locate", " ", "equilibria"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"NSolve", "::", "ratnz"}], "MessageName"], 
      StyleBox["]", "MessageName"]}], 
     StyleBox[";", "MessageName"], 
     RowBox[{"eql", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"eqV", "[", 
             RowBox[{"V", ",", "W", ",", "Ca"}], "]"}], "\[Equal]", "0.0"}], 
           ",", 
           RowBox[{
            RowBox[{"eqW", "[", 
             RowBox[{"V", ",", "W"}], "]"}], "\[Equal]", "0.0"}]}], "}"}], "/.",
          "pars"}], ",", 
        RowBox[{"{", 
         RowBox[{"V", ",", "W"}], "}"}], ",", "Reals"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fixedPoints", " ", "=", " ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"V", ",", " ", "W"}], "}"}], " ", "/.", " ", "eql"}], " ", 
        ",", " ", 
        RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Black", ",", " ", 
            RowBox[{"PointSize", "[", "0.02", "]"}]}], "}"}], "}"}]}], ",", 
        RowBox[{"PlotRange", " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "40"}], ",", " ", "20"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.1"}], ",", " ", "0.6"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<V\>\"", ",", "\"\<W\>\""}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"draw", " ", "null", " ", "clines"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"nullClines", " ", "=", " ", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eqV", "[", 
              RowBox[{"V", ",", " ", "W", ",", "Ca"}], "]"}], " ", "/.", " ", 
             "pars"}], ")"}], " ", "==", " ", "0"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eqW", "[", 
              RowBox[{"V", ",", " ", "W"}], "]"}], " ", "/.", " ", "pars"}], 
            ")"}], " ", "==", " ", "0"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"V", ",", " ", 
          RowBox[{"-", "40"}], ",", " ", "20"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"W", ",", " ", 
          RowBox[{"-", "0.1"}], ",", " ", "0.6"}], "}"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<V\>\"", ",", "\"\<W\>\""}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
        RowBox[{"PlotPoints", " ", "\[Rule]", " ", "100"}], ",", " ", 
        RowBox[{"ContourStyle", " ", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Orange"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Dashed", ",", " ", 
             RowBox[{"Darker", "[", "Red", "]"}]}], "}"}]}], "}"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"draw", " ", "vector", " ", "field"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"vectorField", " ", "=", " ", 
      RowBox[{"VectorPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"eqV", "[", 
            RowBox[{"V", ",", " ", "W", ",", "Ca"}], "]"}], ",", " ", 
           RowBox[{"eqW", "[", 
            RowBox[{"V", ",", " ", "W"}], "]"}]}], "}"}], "/.", "pars"}], ",",
         " ", 
        RowBox[{"{", 
         RowBox[{"V", ",", " ", 
          RowBox[{"-", "40"}], ",", " ", "20"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"W", ",", " ", 
          RowBox[{"-", "0.1"}], ",", " ", "0.6"}], "}"}], ",", 
        RowBox[{"VectorStyle", "\[Rule]", " ", "Gray"}], ",", 
        RowBox[{"VectorPoints", "\[Rule]", "Fine"}], ",", 
        RowBox[{"PlotRange", " ", "\[Rule]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "40"}], ",", " ", "20"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.1"}], ",", " ", "0.6"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<V\>\"", ",", "\"\<W\>\""}], "}"}]}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"run", " ", "simulations"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "initialConditions", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sys", " ", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"V", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==",
              " ", 
             RowBox[{"eqV", "[", 
              RowBox[{
               RowBox[{"V", "[", "t", "]"}], ",", " ", 
               RowBox[{"W", "[", "t", "]"}], ",", " ", "Ca"}], "]"}]}], ",", 
            " ", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"W", "[", "t", "]"}], ",", " ", "t"}], "]"}], " ", "==",
              " ", 
             RowBox[{"eqW", "[", 
              RowBox[{
               RowBox[{"V", "[", "t", "]"}], ",", " ", 
               RowBox[{"W", "[", "t", "]"}]}], "]"}]}]}], "}"}], " ", "/.", 
          " ", "pars"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vars", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"V", "[", "t", "]"}], ",", " ", 
           RowBox[{"W", "[", "t", "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tEnd", "=", "1000.0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"trajectories", "=", 
         RowBox[{
          RowBox[{"Reap", "[", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"init", "=", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", "0", "]"}], ",", 
                   RowBox[{"W", "[", "0", "]"}]}], "}"}], "\[Equal]", 
                 RowBox[{"initialConditions", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], " ", ";", 
              "\[IndentingNewLine]", 
              RowBox[{"solution", " ", "=", " ", 
               RowBox[{"NDSolve", "[", 
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{"sys", ",", " ", "init"}], "]"}], ",", " ", "vars", 
                 ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", " ", "0", ",", " ", "tEnd"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Trajectory \>\"", ",", " ", "i", ",", 
                "\"\< : initial point \>\"", ",", " ", "init", " ", ",", " ", 
                "\"\<, final point \>\"", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Thread", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"V", "[", "tEnd", "]"}], ",", 
                    RowBox[{"W", "[", "tEnd", "]"}]}], "}"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"V", "[", "t", "]"}], ",", 
                    RowBox[{"W", "[", "t", "]"}]}], "}"}]}], "]"}], "/.", 
                  "solution"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"t", "\[Rule]", "tEnd"}], "}"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Sow", "[", 
               RowBox[{"ParametricPlot", "[", 
                RowBox[{
                 RowBox[{"vars", " ", "/.", " ", "solution"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", " ", "0", ",", " ", "tEnd"}], "}"}], ",", 
                 RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
                 RowBox[{"PlotStyle", "\[Rule]", 
                  RowBox[{"Darker", "[", "Blue", "]"}]}]}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "initialConditions", "]"}]}], "}"}]}], 
            "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", 
        RowBox[{"Show", "[", 
         RowBox[{
         "vectorField", ",", "trajectories", ",", "nullClines", ",", 
          "fixedPoints"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"vectorField", ",", "nullClines", ",", "fixedPoints"}], 
        "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6842149602606897`*^9, 3.684214972901458*^9}, {
   3.684216265890827*^9, 3.684216295942092*^9}, {3.684216429983124*^9, 
   3.6842164559468727`*^9}, {3.684216487441*^9, 3.684216539215165*^9}, {
   3.684216717132718*^9, 3.6842167535293713`*^9}, {3.684216792014792*^9, 
   3.684216948090811*^9}, {3.6842169874704847`*^9, 3.684217123296563*^9}, {
   3.684217178933083*^9, 3.684217240747828*^9}, {3.684217298951655*^9, 
   3.684217322754793*^9}, 3.684217523738673*^9, {3.684217882820589*^9, 
   3.6842179554013977`*^9}, {3.684217986824456*^9, 3.684218076245056*^9}, {
   3.684218157363532*^9, 3.684218196511654*^9}, {3.684218226710465*^9, 
   3.684218230059585*^9}, {3.684221223577529*^9, 3.68422134366823*^9}, {
   3.6842213766738567`*^9, 3.684221423671937*^9}, {3.6842214584550962`*^9, 
   3.684221539159855*^9}, {3.684221633957801*^9, 3.684221640762398*^9}, {
   3.684221673871037*^9, 3.684222056698704*^9}, {3.684222119995228*^9, 
   3.6842222791028013`*^9}, {3.684222310857464*^9, 3.684222368380294*^9}, {
   3.6842224640274687`*^9, 3.684222478802886*^9}, {3.684222582983652*^9, 
   3.684222668919992*^9}, {3.684222784582831*^9, 3.68422290735781*^9}, {
   3.684222941676785*^9, 3.684222960935747*^9}, {3.684466728703023*^9, 
   3.684466794645322*^9}, {3.684468855611334*^9, 3.684468939707773*^9}, {
   3.684469007193169*^9, 3.6844692133697166`*^9}, {3.684469247373988*^9, 
   3.684469370661408*^9}, {3.68446940123172*^9, 3.684469660308744*^9}, {
   3.6844697115630903`*^9, 3.684469797219705*^9}, {3.6844698791438627`*^9, 
   3.6844700939087954`*^9}, {3.684470146433529*^9, 3.6844701677645407`*^9}, {
   3.684470238560404*^9, 3.6844702391137333`*^9}, {3.6844703294704514`*^9, 
   3.684470359240965*^9}, {3.6844704291467047`*^9, 3.684470536350451*^9}, {
   3.68447058323136*^9, 3.684470592894072*^9}, {3.6844707744146757`*^9, 
   3.6844707764781637`*^9}, {3.6844709001794367`*^9, 
   3.6844709007441597`*^9}, {3.6844709416861153`*^9, 3.684471041904587*^9}, {
   3.684471086187058*^9, 3.684471088608673*^9}, {3.6844711301715717`*^9, 
   3.684471140124374*^9}, {3.684471231275481*^9, 3.684471675616062*^9}, {
   3.6844717515987387`*^9, 3.6844717761471577`*^9}, {3.684471809576696*^9, 
   3.6844718792985153`*^9}, {3.68447191510767*^9, 3.684471991687014*^9}, {
   3.684472061846026*^9, 3.684472062544099*^9}, {3.684472180366705*^9, 
   3.684472187781329*^9}, {3.6844840191485786`*^9, 3.68448402000487*^9}, {
   3.684484127608417*^9, 3.684484170331066*^9}, {3.6844901599161043`*^9, 
   3.684490163863453*^9}, {3.684490564570525*^9, 3.6844905650910378`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"367203c3-faec-448c-885d-d5e9206e20ef"],

Cell[TextData[{
 "Here is a phaseportrait at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "9.3"}], TraditionalForm]],ExpressionUUID->
  "63327ad7-a851-44c6-a759-64482860fe31"],
 ", slightly above the Hopf bifurcation point, where the upper equilibrium is \
unstable"
}], "Text",
 CellChangeTimes->CompressedData["
1:eJwlxUsogwEAB/C1LZoQF0kZUiub0NLEZVtTnolteXzKpDbSFrZaJNHyiMKB
zRozjxNKsSxGiMLI0jiw1mo76MvmVYrDku//Ofz65XT0yNVMBoORScG/cvar
TR+RFnMj7EVqDs+aiA9L/k8w8kUX1P6RU3qyPqaYM0Sk6RZNEyaYn604Npur
ws1T5i48rRIO4LX19yHMFEWHMS+YNYnVb+V2nOvvW8X9ZUtO7KoSu7F8s/ME
f/W2eXC888iHKxVpAexvkdEL+10ktmcro/h4WfGBk5mD7HnqF1YcF2/6PAKs
JZ5F2JESluCHdKIC65R7tXg/EG7AEu+KEh98hJrxaE1xO70gQ4dvNTcm/Ej6
ZnAdh3+OSWPQbqZe6UvawuOs1B18xft244LS7UtMXJze4ydv44+FemSrMG+B
uld7p8e7Zq4Bd5vUNlzEEjuwRna2gfPHQvSN1ROTVuprmYP+D8mJ8wE=
  "],ExpressionUUID->"94a6db3c-68fa-455a-8d48-a40a56b4b37e"],

Cell[BoxData[
 RowBox[{"GraphicsRow", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"phasePortrait", "[", 
      RowBox[{"9.3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"8", ",", "0.43"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "0.42"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.24"}], ",", "0.28"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "30.0"}], ",", 
           RowBox[{"-", "0.1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "31.0"}], ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"phasePortrait", "[", 
      RowBox[{"9.3", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "17.653803731772097`"}], ",", "0.03648783622081585`"}],
          "}"}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684472075817039*^9, 3.684472079171975*^9}, {
   3.6844814851499157`*^9, 3.6844815373968153`*^9}, {3.6844815678770113`*^9, 
   3.684481686508717*^9}, {3.684481824439877*^9, 3.6844819163068123`*^9}, {
   3.684481953602512*^9, 3.684481989381137*^9}, {3.684482037869873*^9, 
   3.6844820892774563`*^9}, {3.684482131246784*^9, 3.684482223563829*^9}, 
   3.684484092702743*^9, {3.6844843395606737`*^9, 3.68448435693852*^9}, {
   3.684484401007099*^9, 3.684484448371023*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"58742ff3-e9d9-4a81-93ff-a24a78e75d48"],

Cell["\<\
As expected, there is a limit cycle (for clarity, the cycle is shown by \
itself in the panel on the right). The cycle is easy to spot since it is \
stable; it attracts three of the trajectories. The other two converge on the \
lower equilibrium, which is stable as well. \
\>", "Text",
 CellChangeTimes->{{3.683964776135131*^9, 3.683964967347437*^9}, {
   3.683965028754643*^9, 3.683965028756803*^9}, {3.684053425326909*^9, 
   3.684053430015729*^9}, {3.6844735038848763`*^9, 3.684473531205822*^9}, {
   3.684473567531537*^9, 3.684473593111326*^9}, {3.6844736686731377`*^9, 
   3.684473801574164*^9}, {3.6844738394887247`*^9, 3.6844738553815928`*^9}, {
   3.6844739289958677`*^9, 3.684474090154101*^9}, {3.684474123557878*^9, 
   3.6844742688821373`*^9}, {3.684474321977748*^9, 3.684474363239541*^9}, {
   3.684474442951288*^9, 3.684474517896854*^9}, {3.684474592697666*^9, 
   3.684474594104718*^9}, {3.6844746937021723`*^9, 3.684474722628981*^9}, {
   3.6844747546131277`*^9, 3.684474915844001*^9}, {3.684475120187978*^9, 
   3.684475230306966*^9}, {3.684475319198538*^9, 3.684475399064529*^9}, {
   3.684475450815531*^9, 3.684475493666556*^9}, {3.684475535089443*^9, 
   3.684475557025177*^9}, {3.684475591060635*^9, 3.684475649634218*^9}, {
   3.684475752817812*^9, 3.684475926356299*^9}, {3.6844760225909233`*^9, 
   3.684476441313636*^9}, {3.684478190952015*^9, 3.6844782964201202`*^9}, {
   3.68447834453168*^9, 3.684478423723484*^9}, {3.68447852544448*^9, 
   3.684478622024213*^9}, {3.68448096271275*^9, 3.684481353489685*^9}, {
   3.684481942513237*^9, 3.6844819449557734`*^9}, {3.6844822591721697`*^9, 
   3.684482297969139*^9}, {3.6844823443419037`*^9, 3.684482365602029*^9}, {
   3.684482401966909*^9, 3.684482422876197*^9}, {3.6844824917358313`*^9, 
   3.684482555309916*^9}, {3.6844828431032133`*^9, 3.684482910986549*^9}, 
   3.6844829775411177`*^9, {3.68448305626103*^9, 3.6844830575774603`*^9}, {
   3.684484459133257*^9, 3.684484477499627*^9}, {3.6844845180417747`*^9, 
   3.684484553406228*^9}},ExpressionUUID->"192b17ef-61c8-4beb-8a3b-\
350599268214"],

Cell[TextData[{
 StyleBox["Q7: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["What is the relationship between the two alternative attractors of \
the model and the different types of behaviours exhibited by a bursting \
pancreatic \[Beta]-cell?  ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.7788200784384127`*^9, 
   3.778820078525074*^9}},ExpressionUUID->"3df9a6a1-32d7-490e-8f42-\
33b660ec8fa4"],

Cell[TextData[StyleBox["The equilibrium in the lower left corner corresponds \
to the resting (OFF) state of the bursting cell; the limit cycle \
characterises the cell\[CloseCurlyQuote]s behaviour during the bursting (ON) \
phase.",
 FontWeight->"Plain"]], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, 3.684482964329597*^9, {
   3.8103738022052813`*^9, 3.8103738911280317`*^9}},
 FontWeight->"Bold",ExpressionUUID->"28c755b0-fc56-4751-abd0-3a7ed1895a4a"],

Cell["", "Text",
 CellChangeTimes->{{3.810373897659917*^9, 
  3.810373897660584*^9}},ExpressionUUID->"f84f13bb-0aa9-4557-9eed-\
7ec9c4aaeb0a"],

Cell["", "Text",ExpressionUUID->"ea573964-64fe-4ed3-aa2b-a3538258f1b1"],

Cell[TextData[{
 "Is the observed cycle the one that emerges from the Hopf bifurcation point? \
To find out, we also construct a phaseportrait at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "9.2"}], TraditionalForm]],ExpressionUUID->
  "0ab955ac-0c49-4ae1-9450-d5525c6c8713"],
 ", slightly below the Hopf bifurcation point, where the upper equilibrium is \
stable:"
}], "Text",
 CellChangeTimes->{{3.68448264835439*^9, 3.684482718702633*^9}, 
   3.6844831561845713`*^9},ExpressionUUID->"eb933df1-1934-4e72-886d-\
5920ba6a6355"],

Cell[BoxData[
 RowBox[{"phasePortrait", "[", 
  RowBox[{"9.2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "0.43"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "0.42"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.24"}], ",", "0.28"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "30.0"}], ",", 
       RowBox[{"-", "0.1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "31.0"}], ",", 
       RowBox[{"-", "0.1"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684472075817039*^9, 3.684472079171975*^9}, {
   3.6844814851499157`*^9, 3.6844815373968153`*^9}, {3.6844815678770113`*^9, 
   3.684481686508717*^9}, {3.684481824439877*^9, 3.6844819163068123`*^9}, {
   3.684481953602512*^9, 3.6844819541611567`*^9}, 3.6844820001209307`*^9, 
   3.68448274005202*^9, {3.684484067561472*^9, 3.684484074481875*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"4017a5e6-1176-4929-b4e7-a001feaebcd1"],

Cell["\<\
As you can see, the phase-portrait has changed very little. In particular, \
the stable limit cycle is still there, ruling out the hypothesis that it \
emerged from the Hopf bifurcation. Weirdly enough, there is now a stable \
equilibrium point inside a stable limit cycle! \
\>", "Text",
 CellChangeTimes->{{3.683964776135131*^9, 3.683964967347437*^9}, {
   3.683965028754643*^9, 3.683965028756803*^9}, {3.684053425326909*^9, 
   3.684053430015729*^9}, {3.6844735038848763`*^9, 3.684473531205822*^9}, {
   3.684473567531537*^9, 3.684473593111326*^9}, {3.6844736686731377`*^9, 
   3.684473801574164*^9}, {3.6844738394887247`*^9, 3.6844738553815928`*^9}, {
   3.6844739289958677`*^9, 3.684474090154101*^9}, {3.684474123557878*^9, 
   3.6844742688821373`*^9}, {3.684474321977748*^9, 3.684474363239541*^9}, {
   3.684474442951288*^9, 3.684474517896854*^9}, {3.684474592697666*^9, 
   3.684474594104718*^9}, {3.6844746937021723`*^9, 3.684474722628981*^9}, {
   3.6844747546131277`*^9, 3.684474915844001*^9}, {3.684475120187978*^9, 
   3.684475230306966*^9}, {3.684475319198538*^9, 3.684475399064529*^9}, {
   3.684475450815531*^9, 3.684475493666556*^9}, {3.684475535089443*^9, 
   3.684475557025177*^9}, {3.684475591060635*^9, 3.684475649634218*^9}, {
   3.684475752817812*^9, 3.684475926356299*^9}, {3.6844760225909233`*^9, 
   3.684476441313636*^9}, {3.684478190952015*^9, 3.6844782964201202`*^9}, {
   3.68447834453168*^9, 3.684478423723484*^9}, {3.68447852544448*^9, 
   3.684478622024213*^9}, {3.68448096271275*^9, 3.684481353489685*^9}, {
   3.684481942513237*^9, 3.6844819449557734`*^9}, {3.6844822591721697`*^9, 
   3.684482297969139*^9}, {3.6844823443419037`*^9, 3.684482365602029*^9}, {
   3.684482401966909*^9, 3.684482422876197*^9}, {3.6844824917358313`*^9, 
   3.684482555309916*^9}, {3.6844828431032133`*^9, 3.684482910986549*^9}, 
   3.6844829775411177`*^9, {3.68448305626103*^9, 3.6844830575774603`*^9}, {
   3.684483190726551*^9, 3.684483270024087*^9}, {3.684483349752879*^9, 
   3.684483387186635*^9}},ExpressionUUID->"2731d20e-385f-4af8-879b-\
09523096e2dd"],

Cell[TextData[{
 StyleBox["Q8: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Verify that the upper equilibrium really is stable at at ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "9.2"}], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"25526132-f99b-47a9-83c4-afa9e653b666"],
 StyleBox[" and attempt to reconcile this fact with the observation that the \
equilibrium is enclosed by a stable limit cycle.  ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.68448391381952*^9, 
   3.68448391382358*^9}, {3.684484238316971*^9, 3.684484270380843*^9}, {
   3.778820081802311*^9, 
   3.778820081960586*^9}},ExpressionUUID->"67c9717e-070a-4c6b-b196-\
4c77ef20e656"],

Cell["\<\
The stability of the equilibrium point can be verified by performing a linear \
stability analysis. Indeed, for the upper equilibrium, the eigenvalues of the \
Jacobian have negative real parts, proving that the equilibrium is stable \
with respect to small, local perturbations \
\>", "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, 3.68448391381952*^9, {
   3.810373981102644*^9, 
   3.810374084062481*^9}},ExpressionUUID->"12643bff-ca5f-416d-83bc-\
9f9f535496dd"],

Cell[BoxData[
 RowBox[{"stabilityAnalysis", "[", "9.2", "]"}]], "Input",
 CellChangeTimes->{{3.684472530339024*^9, 3.684472538217641*^9}, {
   3.68447884981439*^9, 3.684478912317293*^9}, {3.6844790811661654`*^9, 
   3.684479082108912*^9}, {3.684479547592057*^9, 3.684479551009321*^9}, {
   3.684479793595368*^9, 3.684479794714405*^9}, {3.810373290492736*^9, 
   3.810373317549736*^9}, {3.81037351475944*^9, 3.810373568311296*^9}, {
   3.810373604131915*^9, 3.810373622832699*^9}, 3.810373975621992*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"2e98a212-2661-4445-9105-6d6a7dc5212b"],

Cell["\<\
In fact, we can also show by simulation that equilibrium is stable. If we \
start close enough to the equilibrium point, the simulation will converge to \
it (very slowly), but if we start a little but further away, we converge on \
the large limit cycle:\
\>", "Text",
 CellChangeTimes->{{3.810374126744528*^9, 3.810374177453742*^9}, {
  3.810374379954318*^9, 
  3.810374416211761*^9}},ExpressionUUID->"403dd133-0b6a-4bdd-be83-\
ea9d68032be5"],

Cell[BoxData[
 RowBox[{"phasePortrait", "[", 
  RowBox[{"9.2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4.25", ",", " ", "0.31"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4.25", ",", " ", "0.33"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684472075817039*^9, 3.684472079171975*^9}, {
   3.6844814851499157`*^9, 3.6844815373968153`*^9}, {3.6844815678770113`*^9, 
   3.684481686508717*^9}, {3.684481824439877*^9, 3.6844819163068123`*^9}, {
   3.684481953602512*^9, 3.6844819541611567`*^9}, 3.6844820001209307`*^9, 
   3.68448274005202*^9, {3.684484067561472*^9, 3.684484074481875*^9}, {
   3.810374186721665*^9, 3.810374312984164*^9}, {3.81037435782185*^9, 
   3.81037437215654*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"17dea889-274a-4ca3-9237-441f93bf1b55"],

Cell["\<\
Accordingly, we are led to the conclusion, that there is an unstable limit \
cycle, surrounding the equilibrium point, that is hidden within the large \
limit cycle!\
\>", "Text",
 CellChangeTimes->{{3.810374426929504*^9, 
  3.810374482022092*^9}},ExpressionUUID->"11291e5d-a28f-42d6-abd7-\
343e92e5736f"],

Cell["", "Text",
 CellChangeTimes->{{3.810374426929504*^9, 
  3.8103744812460623`*^9}},ExpressionUUID->"a4229f7b-91c2-4542-8407-\
5a65d6551278"],

Cell[TextData[{
 StyleBox["Q9: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["It can be shown that the Hopf bifurcation is ",
  FontWeight->"Bold"],
 StyleBox["sub-critical",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[". How does this piece of information fit in with your answer to \
the previous question?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.778820085485022*^9, 
   3.7788200858199263`*^9}},ExpressionUUID->"58d44244-5a10-4722-9e53-\
c8d9ef9789ca"],

Cell[TextData[{
 StyleBox["The subcritical variant of the Hopf bifurcation is associated with \
the emergence of an unstable limit cycle that branches off from the \
equilibrium point at the bifurcation point. This fits with our earlier \
conclusion. Apparently, the Hopf bifurcation at ",
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", " ", "\[TildeTilde]", "9.265"}], TraditionalForm]],
  FormatType->"TraditionalForm",
  FontWeight->"Plain",ExpressionUUID->"dcc98a69-f3dc-4550-85ce-cd595f76587c"],
 " is where the unstable limit cycle collides with the spiral equilibrium \
point. "
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, 
   3.684484698370085*^9, {3.810374490108367*^9, 3.810374703089115*^9}},
 FontWeight->"Bold",ExpressionUUID->"afb481a6-150e-4581-b73c-198bad115cdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Following the fate of the limit cycle", "Subsection",
 CellChangeTimes->{{3.684480939473117*^9, 3.684480944495893*^9}, {
  3.684491502980364*^9, 
  3.684491539484096*^9}},ExpressionUUID->"95355126-a2d6-4a8f-b8c2-\
0ab8c8811150"],

Cell[TextData[{
 "Given that the stable limit cycle does not originate at the Hopf \
bifurcation point, we will now try to find out what happens to the cycle as \
the intracellular ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "20f7727c-8250-4a87-b0f7-9dcc1c0fe10c"],
 "concentration is varied. One way to do this is to run a simulation until it \
converges on the cycle and then record the lowest and the highest value of \
the membrane potential observed along the limit cycle. By repeating this \
procedure for a range of different ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "122d2d68-87d7-4d86-9dd4-ff50dce3bb9c"],
 "concentrations, we can get a quick impression of how the amplitude of the \
oscillations changes with the value of the parameter. Below is a procedure \
that produces the desired data"
}], "Text",
 CellChangeTimes->{{3.6844847026517963`*^9, 3.684484728188079*^9}, {
  3.684484774449*^9, 3.6844847801449833`*^9}, {3.684484827638619*^9, 
  3.684484998803562*^9}, {3.684485052607584*^9, 3.684485071718067*^9}, {
  3.6844851307896547`*^9, 
  3.684485236653305*^9}},ExpressionUUID->"ae00f494-656f-48ee-8fcc-\
edf0541de71a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"followLimitCycle", "[", 
    RowBox[{"Ca0_", ",", "Ca1_", ",", " ", "initialCondition_List"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nStep", " ", "=", " ", "40"}], ",", "Ca", ",", "sys", ",", 
       " ", "vars", ",", " ", "tConverge", ",", "tCycle", ",", " ", "init", 
       ",", " ", "solution", ",", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tConverge", " ", "=", " ", "1000.0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tCycle", " ", "=", " ", "1000.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"vars", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", " ", 
         RowBox[{"W", "[", "t", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", " ", "=", " ", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"V", "[", "0", "]"}], ",", " ", 
           RowBox[{"W", "[", "0", "]"}]}], "}"}], " ", "==", " ", 
         "initialCondition"}], "]"}]}], " ", ";", "\[IndentingNewLine]", "\n",
       "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "do", " ", "for", " ", "a", " ", "range", " ", "of", " ", "calcium", 
        " ", "concentrations"}], " ", "*)"}], "\n", "  ", 
      RowBox[{"pts", "=", 
       RowBox[{
        RowBox[{"Reap", "[", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Ca", "=", 
             RowBox[{"Ca0", "+", 
              RowBox[{"i", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Ca1", "-", "Ca0"}], ")"}], "/", "nStep"}]}]}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"sys", "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"V", "[", "t", "]"}], ",", "t"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"eqV", "[", 
                  RowBox[{
                   RowBox[{"V", "[", "t", "]"}], ",", 
                   RowBox[{"W", "[", "t", "]"}], ",", "Ca"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"W", "[", "t", "]"}], ",", "t"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"eqW", "[", 
                  RowBox[{
                   RowBox[{"V", "[", "t", "]"}], ",", 
                   RowBox[{"W", "[", "t", "]"}]}], "]"}]}]}], "}"}], "/.", 
              "pars"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "allow", " ", "to", " ", "converge", " ", "on", " ", "cycle"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"solution", "=", 
             RowBox[{"NDSolve", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"sys", ",", "init"}], "]"}], ",", "vars", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "tConverge"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "simulate", " ", "dynamics", " ", "along", " ", "cycle"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"init", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", "0", "]"}], ",", " ", 
                   RowBox[{"W", "[", "0", "]"}]}], "}"}], " ", "==", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", "t", "]"}], ",", 
                   RowBox[{"W", "[", "t", "]"}]}], "}"}]}], "]"}], "/.", 
               "solution"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", "tConverge"}], "}"}]}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"solution", "=", 
             RowBox[{"NDSolve", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"sys", ",", "init"}], "]"}], ",", "vars", ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "tCycle"}], "}"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "locate", " ", "minimum", " ", "and", " ", "maximum", " ", 
              "value"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ca", ",", 
                RowBox[{"NMinValue", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "t", "]"}], "/.", "solution"}], "//", 
                    "First"}], ",", 
                    RowBox[{
                    "0", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", 
                    "tCycle"}]}], "}"}], ",", "t"}], "]"}]}], "}"}], ",", 
              "minval"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Sow", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ca", ",", 
                RowBox[{"NMaxValue", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"V", "[", "t", "]"}], "/.", "solution"}], "//", 
                    "First"}], ",", 
                    RowBox[{
                    "0", "\[LessEqual]", " ", "t", "\[LessEqual]", " ", 
                    "tCycle"}]}], "}"}], ",", "t"}], "]"}]}], "}"}], ",", 
              "maxval"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "use", " ", "last", " ", "point", " ", "as", " ", "initial", " ",
               "point", " ", "for", " ", "next", " ", "simulation"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"init", " ", "=", "  ", 
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", "0", "]"}], ",", " ", 
                   RowBox[{"W", "[", "0", "]"}]}], "}"}], " ", "==", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"V", "[", "t", "]"}], ",", 
                   RowBox[{"W", "[", "t", "]"}]}], "}"}]}], "]"}], "/.", 
               "solution"}], "/.", 
              RowBox[{"{", 
               RowBox[{"t", "\[Rule]", "tCycle"}], "}"}]}]}]}], " ", "\n", 
           "   ", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "nStep"}], "}"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.684485270663686*^9, 3.684485766317037*^9}, {
   3.684485798986438*^9, 3.6844858359733543`*^9}, {3.684485917114937*^9, 
   3.684486074618801*^9}, {3.6844861584544697`*^9, 3.684486202236565*^9}, {
   3.684486242380063*^9, 3.684486245582144*^9}, {3.684486330614003*^9, 
   3.6844864034060993`*^9}, {3.684486711949752*^9, 3.6844868161927137`*^9}, {
   3.684486877388987*^9, 3.6844868855989447`*^9}, {3.684486917922636*^9, 
   3.684486921741789*^9}, {3.684486991980358*^9, 3.6844869929049797`*^9}, {
   3.684487075268136*^9, 3.684487096238297*^9}, {3.684487146827909*^9, 
   3.6844871476292953`*^9}, {3.684487232844492*^9, 3.684487237948051*^9}, {
   3.6844873549897547`*^9, 3.684487360427464*^9}, {3.684487398742757*^9, 
   3.684487439355172*^9}, {3.6844874943258657`*^9, 3.684487618486868*^9}, 
   3.6844876671135807`*^9, {3.68448772646224*^9, 3.68448772953872*^9}, {
   3.684487831911248*^9, 3.684488011346878*^9}, {3.6844880868161697`*^9, 
   3.68448815692316*^9}, {3.684488191923833*^9, 3.6844881940677643`*^9}, {
   3.684488233795351*^9, 3.684488279242611*^9}, {3.6844883100285063`*^9, 
   3.684488511842526*^9}, {3.68448857444762*^9, 3.6844885830291967`*^9}, {
   3.684488730923706*^9, 3.684488874168385*^9}, {3.684488921827837*^9, 
   3.684488944105812*^9}, {3.684489231356773*^9, 3.684489249179626*^9}, 
   3.68448935977155*^9, {3.684489780661532*^9, 3.6844897811008673`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"7e130394-b910-4999-a19c-4617bb8e53cf"],

Cell[TextData[{
 "The figure below indicates the range of the membrane potential (minimum & \
maximum) as it oscillates along the stable limit cycle. The points are shown \
for ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "a46a1c05-0320-4d53-a42a-8e8f56150b48"],
 "concentrations between 2 and 9.5, and superimposed on the curves that \
indicate the location of the equilibrium points. The red dot pinpoints the \
position of the Hopf bifurcation point. "
}], "Text",
 CellChangeTimes->{{3.6844847026517963`*^9, 3.684484728188079*^9}, {
  3.684484774449*^9, 3.6844847801449833`*^9}, {3.684484827638619*^9, 
  3.684484998803562*^9}, {3.684485052607584*^9, 3.684485071718067*^9}, {
  3.6844851307896547`*^9, 3.684485236653305*^9}, {3.6844894242435827`*^9, 
  3.684489435480501*^9}, {3.684489508254097*^9, 3.684489733605801*^9}, {
  3.684489867084441*^9, 3.684489872500813*^9}, {3.684490597097521*^9, 
  3.684490617227832*^9}},ExpressionUUID->"f75c34f0-109b-4bbb-8b89-\
d6ca844ce441"],

Cell[BoxData[
 RowBox[{"plLeft", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"equilibria", ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"followLimitCycle", "[", 
       RowBox[{"9.5", ",", "2.0", ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.25"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Blue", "]"}], ",", " ", 
          RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}], "}"}]}]}], "]"}], 
    ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Orange", ",", 
       RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{"9.265", ",", "4.250844678619417`"}], "}"}], "]"}]}], "}"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684485869251153*^9, 3.684485910878695*^9}, {
   3.6844871499151793`*^9, 3.684487150738578*^9}, 3.684488563550302*^9, {
   3.684488641830817*^9, 3.6844886425821*^9}, {3.684488681565935*^9, 
   3.68448871512144*^9}, {3.6844893413931837`*^9, 3.684489351806611*^9}, {
   3.684489753942774*^9, 3.684489754659751*^9}, {3.684491563690971*^9, 
   3.684491572772498*^9}, {3.684493349061562*^9, 3.684493365056026*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"a706f0f5-8490-48e9-a2b5-b24df676ba27"],

Cell[TextData[{
 StyleBox["Q10: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["The amplitude of the stable limit cycle at first decreases \
gradually with the calcium concentration, but there appears to be a sudden \
change at ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"Ca", " ", "\[TildeTilde]", " ", "3.5"}],
    FontWeight->"Bold"], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"36a3e503-99cf-49db-9b0e-9ebdf049aca0"],
 StyleBox[". Examine how the phaseportrait changes around this point, and \
infer what kind of bifurcation occurs, making use of the insights you \
obtained in the previous two questions.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490874799306*^9}, {3.778820090058679*^9, 
   3.7788200904747066`*^9}},ExpressionUUID->"708a48e1-85ce-45df-a8d5-\
c0b356493cb5"],

Cell["\<\
To the right of the bifurcation point, we still find evidence of a stable \
limit cycle, containing a smaller, unstable limit cycle that circles around a \
stable equilibrium point... (note that the unstable limit cycle must be \
located somewhere between the two trajectories shown below, so it lies quite \
close to the stable limit cycle)\
\>", "Text",
 CellChangeTimes->{{3.8103811781880836`*^9, 3.810381258636957*^9}, {
  3.810381349366447*^9, 
  3.810381404840016*^9}},ExpressionUUID->"0e1fb298-fb86-4bec-afda-\
82b9e9ada9eb"],

Cell[BoxData[
 RowBox[{"phasePortrait", "[", 
  RowBox[{"3.6", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8.47"}], ",", " ", "0.208"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6.0"}], ",", " ", "0.208"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.684472075817039*^9, 3.684472079171975*^9}, {
   3.6844814851499157`*^9, 3.6844815373968153`*^9}, {3.6844815678770113`*^9, 
   3.684481686508717*^9}, {3.684481824439877*^9, 3.6844819163068123`*^9}, {
   3.684481953602512*^9, 3.6844819541611567`*^9}, 3.6844820001209307`*^9, 
   3.68448274005202*^9, {3.684484067561472*^9, 3.684484074481875*^9}, {
   3.810374186721665*^9, 3.810374312984164*^9}, {3.81037435782185*^9, 
   3.81037437215654*^9}, {3.8103809363527937`*^9, 3.810381079459227*^9}, {
   3.8103811177124043`*^9, 3.8103811482797194`*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"4fce2dc3-695c-4e06-a77a-29302ea7d577"],

Cell["\<\
To the left of the bifurcation point, we can no longer find evidence of a \
stable limit cycle; it appears to have collided with the unstable limit \
cycle, leading to the annihilation of both cycles in a so-called \
fold-bifurcation of limit cycles.\
\>", "Text",
 CellChangeTimes->{{3.8103811781880836`*^9, 3.810381258636957*^9}, {
  3.810381410422495*^9, 
  3.810381481966794*^9}},ExpressionUUID->"9833edc6-c413-4e47-8a8f-\
7187504553e7"],

Cell[BoxData[
 RowBox[{"phasePortrait", "[", 
  RowBox[{"3.4", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "8.8"}], ",", " ", "0.208"}], "}"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.684472075817039*^9, 3.684472079171975*^9}, {
   3.6844814851499157`*^9, 3.6844815373968153`*^9}, {3.6844815678770113`*^9, 
   3.684481686508717*^9}, {3.684481824439877*^9, 3.6844819163068123`*^9}, {
   3.684481953602512*^9, 3.6844819541611567`*^9}, 3.6844820001209307`*^9, 
   3.68448274005202*^9, {3.684484067561472*^9, 3.684484074481875*^9}, {
   3.810374186721665*^9, 3.810374312984164*^9}, {3.81037435782185*^9, 
   3.81037437215654*^9}, {3.8103809363527937`*^9, 3.810381079459227*^9}, {
   3.8103811177124043`*^9, 3.8103811482797194`*^9}, {3.810381278559376*^9, 
   3.810381303205188*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"13725003-932a-4720-bbb9-6bc3075c39f2"],

Cell[TextData[{
 StyleBox["Q11: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Return to the bifurcation diagram you sketched in ",
  FontWeight->"Bold"],
 StyleBox["Q6",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[", and add lines to indicate the amplitude of the stable limit \
cycle. Do the same for the unstable limit cycle that emerges from the Hopf \
bifurcation point and show how these connect to the maximum and minimum of \
the stable limit cycle. A qualitative picture is good enough; it is very \
difficult to locate the exact position of the unstable cycle by simulation.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, {3.684491604192595*^9, 
   3.6844916041963654`*^9}, {3.778820093958684*^9, 3.7788200943410397`*^9}, 
   3.778911512224496*^9},ExpressionUUID->"51cb92fd-2079-4e7d-8971-\
76a7e7c308df"],

Cell[TextData[StyleBox["",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, 
   3.684491604192595*^9},ExpressionUUID->"e128b008-efd3-451a-a8d6-\
c30d951abda7"],

Cell[TextData[{
 "To complete our analysis, we also follow the stable limit cycle as we \
gradually increase the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "dcb5244f-80ca-4ba6-a550-5a28789ed06f"],
 "concentration. The data are added to the previous figure"
}], "Text",
 CellChangeTimes->{{3.6844847026517963`*^9, 3.684484728188079*^9}, {
  3.684484774449*^9, 3.6844847801449833`*^9}, {3.684484827638619*^9, 
  3.684484998803562*^9}, {3.684485052607584*^9, 3.684485071718067*^9}, {
  3.6844851307896547`*^9, 3.684485236653305*^9}, {3.6844894242435827`*^9, 
  3.684489435480501*^9}, {3.684489508254097*^9, 3.684489733605801*^9}, {
  3.684489867084441*^9, 3.684489872500813*^9}, {3.684490597097521*^9, 
  3.684490617227832*^9}, {3.6844915997119513`*^9, 
  3.684491699982644*^9}},ExpressionUUID->"a03d1aea-048c-4652-bb1c-\
9be1dfff53f8"],

Cell[BoxData[
 RowBox[{"plFull", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"plLeft", ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"followLimitCycle", "[", 
       RowBox[{"9.5", ",", "19.0", ",", 
        RowBox[{"{", 
         RowBox[{"4.0", ",", "0.25"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Darker", "[", "Blue", "]"}], ",", " ", 
          RowBox[{"PointSize", "[", "0.01", "]"}]}], "}"}], "}"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684485869251153*^9, 3.684485910878695*^9}, {
   3.6844871499151793`*^9, 3.684487150738578*^9}, 3.684488563550302*^9, {
   3.684488641830817*^9, 3.6844886425821*^9}, {3.684488681565935*^9, 
   3.68448871512144*^9}, {3.6844893413931837`*^9, 3.684489351806611*^9}, {
   3.684489753942774*^9, 3.684489754659751*^9}, {3.684491563690971*^9, 
   3.684491572772498*^9}, {3.684491714360281*^9, 3.68449181293864*^9}, {
   3.684492381199298*^9, 3.6844923828585987`*^9}, {3.6844933779144*^9, 
   3.6844933810525503`*^9}},
 CellLabel->
  "In[232]:=",ExpressionUUID->"63c6a7ed-f798-4b41-9aa3-acb63944138f"],

Cell[TextData[{
 "Also at a high  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],ExpressionUUID->
  "c8c2790e-377d-4c84-9dac-120798ca4d4d"],
 "concentration the stable limit cycle appears to collapse suddenly. Below is \
a phase-portrait showing the stable limit cycle at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Ca", "=", "17.8"}], TraditionalForm]],ExpressionUUID->
  "c930ee32-99c0-40fb-b455-e4b401840e28"],
 ", just before it disappears."
}], "Text",
 CellChangeTimes->{{3.6844921864882793`*^9, 
  3.6844923312190647`*^9}},ExpressionUUID->"32fa0bc6-41a8-4136-b631-\
1fd3e1022beb"],

Cell[BoxData[
 RowBox[{"phasePortrait", "[", 
  RowBox[{"17.8", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "22.109208183373173`"}], ",", "0.023591190228318504`"}], 
     "}"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684491953993863*^9, 3.684492034055214*^9}, {
  3.684492064303*^9, 
  3.6844920986328077`*^9}},ExpressionUUID->"a2a05124-74ce-4591-8566-\
15c690b39bd2"],

Cell[TextData[{
 StyleBox["Q12: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["What kind of bifurcation is responsible for the loss of the cycle \
at high ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"fbc9d014-435f-4168-aa13-9915592801b2"],
 StyleBox["concentrations? ",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, {3.684491604192595*^9, 
   3.6844916041963654`*^9}, {3.684492345651293*^9, 3.684492368631302*^9}, {
   3.6844924011716223`*^9, 3.684492435141693*^9}, {3.6844926324553003`*^9, 
   3.684492632458993*^9}, {3.778820098465849*^9, 
   3.778820098529664*^9}},ExpressionUUID->"cad3c23d-1ec8-4890-a558-\
47acc68fc755"],

Cell["", "Text",
 CellChangeTimes->{{3.810382141858823*^9, 
  3.810382141860553*^9}},ExpressionUUID->"c8e30835-8def-4a55-9bfd-\
9c5f949d3441"],

Cell["\<\
The stable limit cycle connects to the saddle point, establishing a \
homoclinic orbit (i.e., a connection between the stable and unstable \
manifolds connected to a saddle point). Afterwards, the cycle has \
disappeared. This so-called homoclinic bifurcation is a global bifurcation.\
\>", "Text",
 CellChangeTimes->{{3.810382143291044*^9, 
  3.810382255571026*^9}},ExpressionUUID->"3e511f64-fb91-4762-96a0-\
1eabde34d8ed"],

Cell[TextData[StyleBox["",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, {3.684491604192595*^9, 
   3.6844916041963654`*^9}, {3.684492345651293*^9, 3.684492368631302*^9}, {
   3.6844924011716223`*^9, 3.684492435141693*^9}, 
   3.6844926324553003`*^9},ExpressionUUID->"08032575-026a-4dd3-948c-\
31bb603c5a86"],

Cell[TextData[{
 StyleBox["Q13: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Imagine that you would be able to experimentally manipulate the \
intracellular ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"d2a3a7fd-5d49-4807-9ca7-ecf733e6ba1b"],
 StyleBox["concentration in a pancreatic \[Beta]-cell. How would the \
electrical activity of the cell change if you would very slowly increase the ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Bold",ExpressionUUID->"28644edd-2ced-4f0f-b27d-f50684454a0b"],
 StyleBox["concentration from 0 to 20? How would it change if you would next \
decrease the concentration to 0 again?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, {3.684491604192595*^9, 
   3.6844916041963654`*^9}, {3.684492345651293*^9, 3.684492368631302*^9}, {
   3.6844924011716223`*^9, 3.684492435137795*^9}, {3.684492641638691*^9, 
   3.684492644243245*^9}, {3.684492676485959*^9, 3.684492829260111*^9}, {
   3.778820101673099*^9, 3.778820101772008*^9}, {3.8103822791052094`*^9, 
   3.810382279106924*^9}},ExpressionUUID->"b0f64498-b6f2-417b-b1d0-\
8ef748f0bd51"],

Cell[TextData[{
 "Starting from low ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "59b401cd-9b40-471e-977c-75970ba8141c"],
 " concentrations, the system would initially stabilise at the stable spiral \
point (i.e., at high ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4ec29bd5-368a-48d0-876b-901036be1006"],
 ") and stay there until the stability of the equilibrium is lost at the Hopf \
bifurcation (around ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "080df901-f18f-4e5e-ba23-0e0481597f97"],
 "] = 9.2). After going through the bifurcation, the system would jump to the \
closest stable attractor, which is the stable limit cycle. The amplitude of \
the cycle would increase as  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6bac52fb-b22f-4584-be99-5c4b55de183f"],
 "]  increases, up to the point that the cycle connects to the saddle point \
(shortly after ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "eb4822dc-48f3-4c7e-9f77-28424b196e32"],
 "] = 17.8). The loss of the cycle next causes the system to converge on the \
only remaining stable attractor, the equilibrium at low ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2962726a-7a3e-4774-884a-dcf7b0956ae5"],
 ", which corresponds to the resting state equilibrium."
}], "Text",
 CellChangeTimes->{{3.6839654986734343`*^9, 3.68396551251654*^9}, {
   3.683965551442984*^9, 3.683965862639476*^9}, {3.68396590505615*^9, 
   3.683965968696045*^9}, {3.6839660310347424`*^9, 3.683966044021246*^9}, {
   3.6840536562257547`*^9, 3.684053728836813*^9}, {3.6840544710714273`*^9, 
   3.684054759434245*^9}, {3.68405487253192*^9, 3.684054887159724*^9}, {
   3.684054918148314*^9, 3.6840549505665693`*^9}, {3.6840549895912647`*^9, 
   3.684055117799378*^9}, {3.684055163023621*^9, 3.68405517446024*^9}, {
   3.684055211738501*^9, 3.6840552134481087`*^9}, {3.6840552705866137`*^9, 
   3.684055270668708*^9}, {3.6840553660471888`*^9, 3.684055513882366*^9}, {
   3.684055546653903*^9, 3.684055605766163*^9}, 3.684056896106309*^9, {
   3.684056937816987*^9, 3.68405694385879*^9}, {3.6840572368878202`*^9, 
   3.684057251638556*^9}, {3.684057900274572*^9, 3.6840579003587093`*^9}, {
   3.6844788371694107`*^9, 3.684478837224614*^9}, {3.684479189043762*^9, 
   3.684479277305757*^9}, {3.684479675525605*^9, 3.684479678079468*^9}, {
   3.684479918032226*^9, 3.684479966844119*^9}, {3.684482964329597*^9, 
   3.6844830886330967`*^9}, {3.684483390604362*^9, 3.6844834542315683`*^9}, {
   3.684483542184972*^9, 3.684483603664117*^9}, {3.684483800640478*^9, 
   3.684483816975622*^9}, {3.6844838603389807`*^9, 3.6844839058361683`*^9}, {
   3.684484698370085*^9, 3.684484698375082*^9}, {3.684489912791206*^9, 
   3.684489991567374*^9}, {3.684490046719942*^9, 3.6844900491910553`*^9}, {
   3.684490410858032*^9, 3.684490484554871*^9}, {3.6844905238767157`*^9, 
   3.684490554611904*^9}, {3.684490648395455*^9, 3.684490729142807*^9}, {
   3.684490811155916*^9, 3.684490927442217*^9}, {3.684490969154413*^9, 
   3.6844910490303793`*^9}, {3.684491081621364*^9, 3.684491138586075*^9}, {
   3.68449120049612*^9, 3.6844914140357733`*^9}, {3.684491604192595*^9, 
   3.6844916041963654`*^9}, {3.684492345651293*^9, 3.684492368631302*^9}, {
   3.6844924011716223`*^9, 3.684492435137795*^9}, {3.684492641638691*^9, 
   3.684492644243245*^9}, {3.684492676485959*^9, 3.684492829260111*^9}, {
   3.778820101673099*^9, 3.778820101772008*^9}, {3.810382302744269*^9, 
   3.810382595094222*^9}},ExpressionUUID->"71740803-bbf3-4cfd-b212-\
282d78b2a31d"],

Cell[TextData[{
 "If the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2b845f9f-8ff7-425c-b2eb-fb786da1f8bf"],
 " is decreased again from that point onwards, the cell would stay trapped in \
the resting state equilibrium, until this equilibrium disappears through a \
fold bifurcation (around ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "0ff2fba1-0634-44f8-881f-1586aa52c038"],
 "] = 5.8). From there, the system would be forced to converge to the stable \
limit cycle, and it would remain on that attractor until the cycle disappears \
at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "3887ffbe-a4e0-42ec-9881-68ea4069b57c"],
 " = 3.5. At even lower ",
 Cell[BoxData[
  FormBox[
   RowBox[{"[", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]], "]"}], TraditionalForm]],ExpressionUUID->
  "d65e059a-46cc-490a-9d1e-cfffaedfa664"],
 ", the cell would converge on the only remaining equilibrium, the stable \
spiral point where it started originally."
}], "Text",
 CellChangeTimes->{{3.810382605647079*^9, 3.810382675967279*^9}, {
  3.810382708645095*^9, 
  3.810382873414073*^9}},ExpressionUUID->"e623e4dd-8a88-42d6-820a-\
2531957ecf9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Modelling the bursting behaviour", "Subsection",
 CellChangeTimes->{{3.684480939473117*^9, 3.684480944495893*^9}, {
  3.684491502980364*^9, 3.68449150830857*^9}, {3.684492596632599*^9, 
  3.684492604633017*^9}},ExpressionUUID->"4439671e-443a-493e-afb5-\
33e9c43d4f3c"],

Cell[TextData[{
 "Now that we understand how ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->"449cf29b-6a56-4e1f-af37-9c188b061ea1"],
 "controls the transition between the oscillatory and resting phase, we are \
ready to model the spontaneous bursting observed in pancreatic \[Beta]-cells. \
For this purpose, we extend the model with an additional equation that \
describes the change of the intracellular ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SuperscriptBox["Ca", 
     RowBox[{"2", "+"}]]}], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->"1b672a5a-c9f1-4391-b21a-cacfbd366622"],
 "concentration."
}], "Text",
 CellChangeTimes->{{3.6844921864882793`*^9, 3.6844923312190647`*^9}, {
  3.684492863740909*^9, 3.684492900125483*^9}, {3.6844929315682907`*^9, 
  3.684493119737151*^9}},ExpressionUUID->"e7029cdf-c7e0-4e62-a8b4-\
ca1655b5d0a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqCa", "[", 
   RowBox[{"V_", ",", "Ca_"}], "]"}], ":=", 
  RowBox[{"0.002", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.2"}], 
      SubscriptBox["g", "ca"], 
      RowBox[{
       SubscriptBox["m", "\[Infinity]"], "[", "V", "]"}], 
      RowBox[{"(", 
       RowBox[{"V", "-", 
        SubscriptBox["v", "ca"]}], ")"}]}], "-", "Ca"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.684466528064533*^9, 3.684466580752808*^9}, {
   3.68446666045063*^9, 3.6844666761674767`*^9}, 3.684467216793598*^9, {
   3.684467248073182*^9, 3.684467249617568*^9}, {3.684468116494741*^9, 
   3.684468126644281*^9}, {3.684468163007204*^9, 3.684468163082959*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"a9e8c1e2-7be8-4567-bccc-5fcbfe6c3beb"],

Cell[TextData[{
 "A simulation of the extended model nicely shows the bursting behaviour, \
triggered by a slow decrease of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->"cd0ca8e6-5e09-440f-919e-b24403ea1da7"],
 "during the resting phase and an increase of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->"375af7ea-752e-4319-b579-a29361466941"],
 "during the oscillatory phase. "
}], "Text",
 CellChangeTimes->{{3.6844935354663363`*^9, 
  3.6844936745570507`*^9}},ExpressionUUID->"e14147ba-eb2e-40b6-b371-\
97e94e1780e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tEnd", " ", "=", " ", "4000.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sys", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
       RowBox[{"eqV", "[", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", 
         RowBox[{"W", "[", "t", "]"}], ",", 
         RowBox[{"Ca", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"W", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
       RowBox[{"eqW", "[", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", 
         RowBox[{"W", "[", "t", "]"}]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Ca", "[", "t", "]"}], ",", "t"}], "]"}], "\[Equal]", 
       RowBox[{"eqCa", "[", 
        RowBox[{
         RowBox[{"V", "[", "t", "]"}], ",", 
         RowBox[{"Ca", "[", "t", "]"}]}], "]"}]}]}], "}"}], "/.", "pars"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"V", "[", "t", "]"}], ",", 
     RowBox[{"W", "[", "t", "]"}], ",", 
     RowBox[{"Ca", "[", "t", "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"V", "[", "0", "]"}], "\[Equal]", 
      RowBox[{"-", "32.53787782518964`"}]}], ",", 
     RowBox[{
      RowBox[{"W", "[", "0", "]"}], "\[Equal]", "0.00593584822774111`"}], ",", 
     RowBox[{
      RowBox[{"Ca", "[", "0", "]"}], "\[Equal]", "7.995453830994973`"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"sys", ",", "init"}], "]"}], ",", "vars", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V", "[", "t", "]"}], ",", 
       RowBox[{"Ca", "[", "t", "]"}]}], "}"}], "/.", "solution"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tEnd"}], "}"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Darker", "[", "Red", "]"}], ",", "Gray"}], "}"}]}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<time\>\"", ",", "\"\<V,Ca\>\""}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6842149602606897`*^9, 3.684214972901458*^9}, {
   3.684216265890827*^9, 3.684216295942092*^9}, {3.684216429983124*^9, 
   3.6842164559468727`*^9}, {3.684216487441*^9, 3.684216539215165*^9}, {
   3.684216717132718*^9, 3.6842167535293713`*^9}, {3.684216792014792*^9, 
   3.684216948090811*^9}, {3.6842169874704847`*^9, 3.684217123296563*^9}, {
   3.684217178933083*^9, 3.684217240747828*^9}, {3.684217298951655*^9, 
   3.684217322754793*^9}, 3.684217523738673*^9, {3.684217882820589*^9, 
   3.6842179554013977`*^9}, {3.684217986824456*^9, 3.684218076245056*^9}, {
   3.684218157363532*^9, 3.684218196511654*^9}, {3.684218226710465*^9, 
   3.684218230059585*^9}, {3.684221223577529*^9, 3.68422134366823*^9}, {
   3.6842213766738567`*^9, 3.684221423671937*^9}, {3.6842214584550962`*^9, 
   3.684221539159855*^9}, {3.684221633957801*^9, 3.684221640762398*^9}, {
   3.684221673871037*^9, 3.684222056698704*^9}, {3.684222119995228*^9, 
   3.6842222791028013`*^9}, {3.684222310857464*^9, 3.684222368380294*^9}, {
   3.6842224640274687`*^9, 3.684222478802886*^9}, {3.684222582983652*^9, 
   3.684222668919992*^9}, {3.684222784582831*^9, 3.68422290735781*^9}, {
   3.684222941676785*^9, 3.684222960935747*^9}, {3.684466728703023*^9, 
   3.6844669265079937`*^9}, {3.68446726392416*^9, 3.684467267347474*^9}, {
   3.684467704476424*^9, 3.6844677941593237`*^9}, {3.6844681366769943`*^9, 
   3.6844681367724447`*^9}, {3.684468172553526*^9, 3.6844682757255917`*^9}, {
   3.684493189899439*^9, 3.684493336070671*^9}, {3.684493401112731*^9, 
   3.684493503984009*^9}, {3.684493685581457*^9, 3.6844936938411818`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"eea438ff-2ef3-4415-8552-667bb954fc8b"],

Cell[TextData[{
 "When the trajectory is superimposed on the bifurcation diagram (shown below \
with orange dots indicating the different bifurcation points), it becomes \
clear that the slow change of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Ca", 
    RowBox[{"2", "+"}]], TraditionalForm]],
  FontWeight->"Plain",ExpressionUUID->"b50d726d-4c5a-43db-82e2-17302bc427c0"],
 " concentration pushes the system through the homoclinic and the fold \
bifurcation, inducing a repetitive switch from the stable fixed point to the \
periodic attractor and back."
}], "Text",
 CellChangeTimes->{{3.684494307297949*^9, 3.684494548867352*^9}, {
  3.6844945865170403`*^9, 
  3.684494634800802*^9}},ExpressionUUID->"37a1457d-9efe-43c1-8c49-\
4975cfae2c08"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"plFull", ",", "\[IndentingNewLine]", 
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ca", "[", "t", "]"}], ",", " ", 
        RowBox[{"V", "[", "t", "]"}]}], "}"}], " ", "/.", " ", "solution"}], 
     ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", " ", "0", ",", " ", "tEnd"}], "}"}], ",", " ", 
     RowBox[{"PlotStyle", "\[Rule]", " ", 
      RowBox[{"Darker", "[", "Red", "]"}]}], ",", 
     RowBox[{"PlotRange", " ", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "20"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "40"}], ",", " ", "20"}], "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"Frame", " ", "\[Rule]", " ", "True"}], " ", ",", " ", 
     RowBox[{"AspectRatio", " ", "\[Rule]", " ", "1"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Orange", ",", 
      RowBox[{"PointSize", "[", "0.02", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"5.802", ",", 
         RowBox[{"-", "28.83"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"17.8", ",", 
         RowBox[{"-", "22.41"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"3.5", ",", 
         RowBox[{"-", "9.0"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Point", "[", 
       RowBox[{"{", 
        RowBox[{"3.5", ",", "13.6"}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6844936973955793`*^9, 3.6844937819646463`*^9}, {
  3.684493847479123*^9, 3.684493896011599*^9}, {3.6844939317157373`*^9, 
  3.684493966833123*^9}, {3.684493997089306*^9, 3.684494006107258*^9}, {
  3.684494045054364*^9, 3.684494061769129*^9}, {3.684494130542295*^9, 
  3.684494256097706*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"3fa9ab7b-0e03-4fd7-8537-5eb4eb8e1a55"],

Cell[TextData[{
 StyleBox["Q14: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["A characteristic feature of the bursting of pancreatic \
\[Beta]-cells is that the interval between spikes grows as the cell comes \
closer to the end of the bursting period. Do you also observe this feature in \
the model? Can you give a mathematical explanation for why the slowing down \
occurs?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfawn1H120WvH+nYBTxD9VuedL4ieVnalBET/Pq1Y
BaIZ3MSaQPQcmYedIJpnXUM3iE6yZA8+BqR1jkvFgGglz0c7QHTY07d3QHQt
q+BrEF0m8/QNiP6778gHsLzipS8gesnrTT9BdOOUnZzHQfTBBH4Q7bnrnACI
PruwXBREvwhbB6a7jl6SAdF8aVfB9KSmgxogOsLGxhpEH3sTYg+iM1p2uIHo
kj+t3iD6x5biBBB9NHXWdxDNs8RI8ASQdpn1XwJEl61aZASit0S/TwXRLPkf
wfSb30kb5ha/dlzh2rkVRN8QzNwLonX+3QTTF1T+XQHRUlFKb0H0Auk1wvOA
tIU9hP6xi7FiPpDuO7+8EkRLcF5nbFd/42glchNMAwBM4dBn
  "],ExpressionUUID->"89e7a805-de3d-4043-a654-02f39bbb7ec4"],

Cell["\<\
Yes, the slowing down is clearly visible in the time series plots. It is \
caused by the fact that the dynamics along the limit cycle becomes very slow \
when the cycle gets closer to the saddle point (close to an equilibrium, all \
of the variables changes slowly) as the system approaches the homoclinic \
bifurcation\
\>", "Text",
 CellChangeTimes->{{3.810383142837123*^9, 
  3.810383289373516*^9}},ExpressionUUID->"c0a13cf7-6e95-4f7f-b621-\
49d573fb6b4d"],

Cell[TextData[StyleBox["",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfawn1H120WvH+nYBTxD9VuedL4ieVnalBET/Pq1Y
BaIZ3MSaQPQcmYedIJpnXUM3iE6yZA8+BqR1jkvFgGglz0c7QHTY07d3QHQt
q+BrEF0m8/QNiP6778gHsLzipS8gesnrTT9BdOOUnZzHQfTBBH4Q7bnrnACI
PruwXBREvwhbB6a7jl6SAdF8aVfB9KSmgxogOsLGxhpEH3sTYg+iM1p2uIHo
kj+t3iD6x5biBBB9NHXWdxDNs8RI8ASQdpn1XwJEl61aZASit0S/TwXRLPkf
wfSb30kb5ha/dlzh2rkVRN8QzNwLonX+3QTTF1T+XQHRUlFKb0H0Auk1wvOA
9GnvT2AaABM9wk8=
  "],ExpressionUUID->"438a33e9-6d93-447d-b2bd-a6616830039f"],

Cell[TextData[{
 StyleBox["Q15: ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["Bursting can be generated by different mechanisms. Which other \
mechanism is suggested by the bifurcation diagram of the pancreatic \
\[Beta]-cell? Will this type of bursting also show a slowing down of the \
electrical spiking toward the end of the oscillatory phase?",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfawn1H120WvH+nYBTxD9VuedL4ieVnalBET/Pq1Y
BaIZ3MSaQPQcmYedIJpnXUM3iE6yZA8+BqR1jkvFgGglz0c7QHTY07d3QHQt
q+BrEF0m8/QNiP6778gHsLzipS8gesnrTT9BdOOUnZzHQfTBBH4Q7bnrnACI
PruwXBREvwhbB6a7jl6SAdF8aVfB9KSmgxogOsLGxhpEH3sTYg+iM1p2uIHo
kj+t3iD6x5biBBB9NHXWdxDNs8RI8ASQdpn1XwJEl61aZASit0S/TwXRLPkf
wfSb30kb5ha/dlzh2rkVRN8QzNwLonX+3QTTF1T+XQHRUlFKb0H0Auk1wvOA
dMDc1zIg+o94ucF8kH6b3bEg+k6ZEVO7+hvHqCtWYBoAXOXRAg==
  "],ExpressionUUID->"c18bfdec-aeec-4374-9eae-4036a7a0a688"],

Cell["\<\
The bursting phase could also be ended if the system is pushed through a fold \
bifurcation of limit cycles; this process does not give rise to a slowing \
down of the electrical spiking towards the end of the bursting phase. \
\>", "Text",
 CellChangeTimes->{{3.810383307823292*^9, 
  3.810383390217499*^9}},ExpressionUUID->"3c0cf358-29b4-4a7a-ba3b-\
03ca084f475e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Time-scale separation in a population-genetic model of sexual selection\
\>", "Section",
 CellChangeTimes->{{3.6829992928352165`*^9, 3.6829992962185545`*^9}, {
  3.684053399255887*^9, 3.6840534106583014`*^9}, {3.684654781552939*^9, 
  3.6846548024536753`*^9}, {3.6846563835799923`*^9, 3.6846564374703617`*^9}, {
  3.684656484067334*^9, 3.6846564900882063`*^9}, {3.684682206313883*^9, 
  3.684682228737471*^9}},ExpressionUUID->"5f1b1aad-2420-414b-a14b-\
c0f542f83ec0"],

Cell[TextData[{
 "First, we define the frequencies of genotypes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["P", "0"], 
     SubscriptBox["T", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "8412b8c7-90e0-4f02-a936-afddb83c0331"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "0"], 
    SubscriptBox["T", "1"]}], TraditionalForm]],ExpressionUUID->
  "887c300b-13bb-4bae-9abc-9129665f415a"],
 StyleBox[", ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "1"], 
    SubscriptBox["T", "0"]}], TraditionalForm]],ExpressionUUID->
  "68ad54e5-2fcc-4e2f-b1aa-152b165e9a8f"],
 StyleBox[", ",
  FontSlant->"Italic"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "1"], 
    SubscriptBox["T", "1"]}], TraditionalForm]],ExpressionUUID->
  "5da75ece-4034-495a-a57b-890122de0eb4"],
 ") in zygotes, depending on the allele frequencies ",
 Cell[BoxData[
  FormBox[
   RowBox[{"p", " "}], TraditionalForm]],ExpressionUUID->
  "2e9db45f-250b-48f2-98ad-1c9b57222966"],
 "and ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],ExpressionUUID->
  "76694908-696b-4b65-a6bc-eaba4edb0e8a"],
 " of the alleles ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "1"], TraditionalForm]],ExpressionUUID->
  "19406faf-b0b2-44a8-936e-74059c55bd85"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "1"], TraditionalForm]],ExpressionUUID->
  "c59aa3cc-8f3e-4e1a-a625-d18fb4075e85"],
 " and the linkage disequilibrium \[GothicCapitalD] between them."
}], "Text",
 CellChangeTimes->{{3.6846822531148777`*^9, 
  3.684682500588231*^9}},ExpressionUUID->"324a626a-0d9a-47f8-be4e-\
bf3c1b8da321"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["z", "0"], "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"1", "-", "t"}], ")"}]}], "+", "\[GothicCapitalD]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}], "t"}], "-", "\[GothicCapitalD]"}], ",", 
    RowBox[{
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "t"}], ")"}]}], "-", "\[GothicCapitalD]"}], ",", 
    RowBox[{
     RowBox[{"p", " ", "t"}], "+", "\[GothicCapitalD]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.684658103873087*^9, 3.6846581141624203`*^9}, {
  3.684664016134945*^9, 3.684664099968852*^9}, {3.684664288568405*^9, 
  3.684664290220051*^9}, {3.6846682733440437`*^9, 3.684668274967464*^9}, {
  3.6846683376244926`*^9, 3.684668348137796*^9}, {3.684669435298964*^9, 
  3.684669436186659*^9}},ExpressionUUID->"08d5d68f-a833-4742-8577-\
979a9d112a7e"],

Cell[TextData[{
 "Males carrying allele ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], " "}], TraditionalForm]],ExpressionUUID->
  "d1d57c11-98e6-4e4c-b770-ba30a77ab514"],
 "suffer from a reduced viability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", "s"}], TraditionalForm]],ExpressionUUID->
  "a5b5c4dd-4365-4a24-aab7-248e11b309e8"],
 ". The frequencies after selection are given by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "0"], TraditionalForm]],ExpressionUUID->
  "82837879-1d60-4b76-a800-4eb0db8b2043"],
 " "
}], "Text",
 CellChangeTimes->{{3.684682515034914*^9, 
  3.68468256970888*^9}},ExpressionUUID->"76a26cc4-729f-4b8a-8a6c-\
ee73b56e752c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "-", 
      RowBox[{"\[Epsilon]", " ", "s"}]}], ",", "1", ",", 
     RowBox[{"1", "-", 
      RowBox[{"\[Epsilon]", " ", "s"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "0"], "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["z", "0"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "S"}], 
   RowBox[{
    RowBox[{
     SubscriptBox["z", "0"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], ".", 
    "S"}]]}]}], "Input",
 CellChangeTimes->{{3.684658026166243*^9, 3.6846580383995447`*^9}, {
   3.684658126346505*^9, 3.684658132067712*^9}, {3.684658248997179*^9, 
   3.684658349175232*^9}, {3.684664155483684*^9, 3.684664163670374*^9}, {
   3.684664214357778*^9, 3.684664311061357*^9}, {3.684665078246965*^9, 
   3.684665085522275*^9}, {3.684668293092205*^9, 3.684668301085964*^9}, {
   3.684668381555723*^9, 3.6846684176506042`*^9}, {3.68466847574339*^9, 
   3.684668476742484*^9}, {3.68466944871327*^9, 3.6846694516638193`*^9}, {
   3.6846698769093103`*^9, 3.684669894375718*^9}, 
   3.6846776087438717`*^9},ExpressionUUID->"d199f108-abab-46c6-9ec1-\
02f2c0fb8272"],

Cell[TextData[{
 "Females carrying allele ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "1"], " "}], TraditionalForm]],ExpressionUUID->
  "32e2ab95-b17d-491b-b990-218e26ed5c63"],
 "are more likely to choose a  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], " "}], TraditionalForm]],ExpressionUUID->
  "92b95bcf-7ec3-499b-a8f6-8d3b9b5749ba"],
 "male. The frequencies of these males in mating pairs with a  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "1"], " "}], TraditionalForm]],ExpressionUUID->
  "7a196b2e-70a2-4eb2-89e8-4365ea79b8b9"],
 "female are given by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "1"], TraditionalForm]],ExpressionUUID->
  "b878bb87-6069-4eb4-b80c-f97561874795"]
}], "Text",
 CellChangeTimes->{{3.684682588429669*^9, 
  3.684682650690618*^9}},ExpressionUUID->"a506a725-6d6d-413d-9833-\
84e0d8e5d732"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "+", 
      RowBox[{"\[Epsilon]", " ", "a"}]}], ",", "1", ",", 
     RowBox[{"1", "+", 
      RowBox[{"\[Epsilon]", " ", "a"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["m", "1"], "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["m", "0"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "A"}], 
   RowBox[{
    RowBox[{
     SubscriptBox["m", "0"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], ".", 
    "A"}]]}]}], "Input",
 CellChangeTimes->{{3.684668484355467*^9, 3.684668573007622*^9}, {
   3.6846699020087442`*^9, 3.6846699052320642`*^9}, 
   3.6846776124442997`*^9},ExpressionUUID->"9ea0fcb3-1976-4973-9bf1-\
61638e0f3047"],

Cell[TextData[{
 "The next step is that we need to construct all possible mating pairs, and \
determine the genotype distribution among their offspring. The probabilities \
that a pair ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],ExpressionUUID->
  "83b2e6bd-ce5e-4263-a69a-94d3e5a3e3d9"],
 " produces an offspring ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "93250886-86d0-4e9e-bcc2-ac6778bd0e6e"],
 " are collected in a recombination matrix ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "fd8d4e5f-03d5-4a10-ad8e-c306d25e6e4d"]
}], "Text",
 CellChangeTimes->{{3.684682657700721*^9, 
  3.684682799627221*^9}},ExpressionUUID->"07dba236-a3b2-4d88-8e4f-\
eb639827d8fc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pr", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", 
       RowBox[{"Quotient", "[", 
        RowBox[{"j", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{"j", ",", "4"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"pi", "=", 
       RowBox[{"Quotient", "[", 
        RowBox[{"i", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ti", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{"i", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", "pk", 
      ",", "pl", ",", "tk", ",", "tl"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pk", "=", 
      RowBox[{"Quotient", "[", 
       RowBox[{"k", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tk", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"k", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pl", "=", 
      RowBox[{"Quotient", "[", 
       RowBox[{"l", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tl", "=", 
      RowBox[{"Mod", "[", 
       RowBox[{"l", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", "r"}], "2"], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "\[Equal]", "pk"}], "&&", 
            RowBox[{"ti", "\[Equal]", "tk"}]}], ",", "1", ",", "0"}], "]"}], 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "\[Equal]", "pl"}], "&&", 
            RowBox[{"ti", "\[Equal]", "tl"}]}], ",", "1", ",", "0"}], "]"}]}],
         ")"}]}], "+", 
      RowBox[{
       FractionBox["r", "2"], 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "\[Equal]", "pk"}], "&&", 
            RowBox[{"ti", "\[Equal]", "tl"}]}], ",", "1", ",", "0"}], "]"}], 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pi", "\[Equal]", "pl"}], "&&", 
            RowBox[{"ti", "\[Equal]", "tk"}]}], ",", "1", ",", "0"}], "]"}]}],
         ")"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"R", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Pr", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "15"}], "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.684677621907366*^9, 3.6846778681777067`*^9}, {
  3.684677927833005*^9, 3.68467803877564*^9}, {3.684678190319631*^9, 
  3.684678498795581*^9}, {3.684678608347262*^9, 
  3.684678799559292*^9}},ExpressionUUID->"732f8ae6-18df-4e27-be2a-\
4c5b9e734efb"],

Cell[TextData[{
 "Finally, we model mutation bias acting on the male ornamentation trait; \
mutations occur at rate \[Mu] and change allele ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], " ", "into", " ", 
    SubscriptBox["T", "0"]}], TraditionalForm]],ExpressionUUID->
  "3f422a19-b561-4ed3-9b4c-31f37aa52b14"]
}], "Text",
 CellChangeTimes->{{3.684682808148045*^9, 
  3.6846828850056543`*^9}},ExpressionUUID->"f0c7ecc8-b0ca-484c-bcad-\
88b5886be649"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"M", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"\[Epsilon]", " ", "\[Mu]"}], ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "-", 
         RowBox[{"\[Epsilon]", " ", "\[Mu]"}]}], ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"\[Epsilon]", " ", "\[Mu]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"1", "-", 
         RowBox[{"\[Epsilon]", " ", "\[Mu]"}]}]}], "}"}]}], "}"}]}], ")"}], 
  " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.684679206919113*^9, 
  3.6846793072669363`*^9}},ExpressionUUID->"31f384b8-31a0-4b05-a503-\
dd77a5bb86e9"],

Cell["\<\
We now calculate the genotype frequencies in the next generation...\
\>", "Text",
 CellChangeTimes->{{3.684682895942787*^9, 
  3.684682920367535*^9}},ExpressionUUID->"95cada58-12c1-4517-8ca3-\
0cfa9bba1402"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["z", "1"], "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  RowBox[{"M", ".", "R", ".", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["z", "0"], "[", 
          RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["m", "0"], "[", 
         RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["z", "0"], "[", 
          RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", "4"}], "]"}], "]"}], ",", 
        RowBox[{
         SubscriptBox["m", "1"], "[", 
         RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}]}], "]"}]}], 
     "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.68466868433389*^9, 3.684668716489526*^9}, {
   3.6846688644450417`*^9, 3.684668899926817*^9}, {3.684668965129881*^9, 
   3.684669149679543*^9}, {3.684669251138932*^9, 3.684669300596395*^9}, {
   3.6846693328314734`*^9, 3.6846694205216837`*^9}, {3.6846694553784847`*^9, 
   3.684669475144047*^9}, {3.684669959862844*^9, 3.6846700129078217`*^9}, {
   3.684670084753374*^9, 3.6846700996039457`*^9}, {3.68467020420627*^9, 
   3.684670228420594*^9}, {3.684670350663341*^9, 3.68467049146362*^9}, {
   3.6846705699151773`*^9, 3.684670573833787*^9}, {3.684670641004079*^9, 
   3.6846706816504908`*^9}, 3.684678741467244*^9, {3.684678806751911*^9, 
   3.684678837462576*^9}, {3.684679324857596*^9, 
   3.68467932515311*^9}},ExpressionUUID->"e41c83b3-af97-4391-beb8-\
37d74f8b380a"],

Cell["\<\
...and compute the change in the allele frequencies and linkage \
disequilibrium from there. \
\>", "Text",
 CellChangeTimes->{{3.684682924166314*^9, 
  3.684682947716196*^9}},ExpressionUUID->"6bd88db4-ce28-4ae8-833f-\
6a8245eb9c69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalDelta]p", "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ".", 
    RowBox[{
     SubscriptBox["z", "1"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}]}], "-", 
   "p"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]t", "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}], ".", 
    RowBox[{
     SubscriptBox["z", "1"], "[", 
     RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}]}], "-", 
   "t"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]\[GothicCapitalD]", "[", 
   RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["z", "1"], "[", 
      RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{
     RowBox[{
      SubscriptBox["z", "1"], "[", 
      RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["z", "1"], "[", 
      RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], 
    RowBox[{
     RowBox[{
      SubscriptBox["z", "1"], "[", 
      RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "-", "\[GothicCapitalD]"}]}]}], "Input",
 CellChangeTimes->{{3.684664522716529*^9, 3.684664523225268*^9}, {
  3.684664688065393*^9, 3.684664808511058*^9}, {3.684664871131624*^9, 
  3.684664901790378*^9}, {3.684665027366169*^9, 3.6846650511643763`*^9}, {
  3.684669488453656*^9, 3.6846694991357613`*^9}, {3.684669733621567*^9, 
  3.684669751559197*^9}, {3.684678899656299*^9, 3.684678905137815*^9}, {
  3.684681567182272*^9, 
  3.684681567284957*^9}},ExpressionUUID->"5788d85c-58c3-4b2c-a039-\
5b40b0531f2f"],

Cell["\<\
The following is to check the equations for the case that there is no \
selection or mutation. As expected, the allele frequencies do not change, and \
the linkage disequilibrium decays at a rate proportional to the recombination \
rate.\
\>", "Text",
 CellChangeTimes->{{3.684682953325289*^9, 
  3.684683048516773*^9}},ExpressionUUID->"593d7457-488a-491e-aab7-\
a9172c94ae9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]p", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", "\[Rule]", "0"}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]t", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", "\[Rule]", "0"}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]\[GothicCapitalD]", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", "\[Rule]", "0"}], "}"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.684664908729513*^9, 3.684664932817474*^9}, {
  3.6846649866377163`*^9, 3.684665013270904*^9}, {3.6846651180847282`*^9, 
  3.684665123278357*^9}, {3.684669543221682*^9, 3.684669582715213*^9}, {
  3.684669699032344*^9, 3.684669711876292*^9}, {3.684669776840755*^9, 
  3.6846697781630697`*^9}, {3.6846788471026697`*^9, 3.6846788533272963`*^9}, {
  3.684681571449787*^9, 
  3.684681571521596*^9}},ExpressionUUID->"6908e182-2ad8-4203-b656-\
474ec02301c5"],

Cell["The recurrence equations of the model are quite complicated:", "Text",
 CellChangeTimes->{{3.684682991620306*^9, 3.684682999736205*^9}, {
  3.684683055118847*^9, 
  3.684683075171451*^9}},ExpressionUUID->"6add6505-9073-4085-8d60-\
5a8935c0ce38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]p", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], " ", "/.",
    " ", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", "\[Rule]", " ", "1"}], "}"}]}], " ", "//", " ",
   "FullSimplify"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]t", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], " ", "/.",
    " ", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", "\[Rule]", " ", "1"}], "}"}]}], " ", "//", " ",
   "FullSimplify"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]\[GothicCapitalD]", "[", 
    RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], "]"}], " ", "/.",
    " ", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", "\[Rule]", " ", "1"}], "}"}]}], " ", "//", " ",
   "Simplify"}]}], "Input",
 CellChangeTimes->{{3.68466796631833*^9, 3.684667986288912*^9}, {
  3.684678930127976*^9, 3.684678937393252*^9}, {3.68467934208738*^9, 
  3.6846793425472803`*^9}, {3.684681394265572*^9, 3.6846813958159437`*^9}, {
  3.684681574196601*^9, 
  3.68468157428334*^9}},ExpressionUUID->"58bfcb52-4d8d-46eb-b0c1-\
a78aa3296a6d"],

Cell["But, we can iterate them numerically of course", "Text",
 CellChangeTimes->{{3.684683080963306*^9, 
  3.6846831011410503`*^9}},ExpressionUUID->"67217a8e-9c36-4956-890b-\
c6c402134056"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simulateExactRecursions", "[", 
   RowBox[{"p0_", ",", "t0_", ",", "D0_", ",", "tEnd_", ",", "pars_List"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", "p0"}], ",", 
      RowBox[{"t", "=", "t0"}], ",", 
      RowBox[{"\[GothicCapitalD]", "=", "D0"}], ",", "\[Delta]p", ",", 
      "\[Delta]t", ",", "\[Delta]\[GothicCapitalD]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "}"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Delta]p", "=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]p", "[", 
              RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], 
              "]"}], "/.", "pars"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Delta]t", "=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]t", "[", 
              RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], 
              "]"}], "/.", "pars"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Delta]\[GothicCapitalD]", "=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]\[GothicCapitalD]", "[", 
              RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], 
              "]"}], "/.", "pars"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p", "+=", " ", "\[Delta]p"}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "+=", " ", "\[Delta]t"}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "\[GothicCapitalD]", "+=", " ", "\[Delta]\[GothicCapitalD]"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "}"}], "]"}], 
           ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "tEnd"}], "}"}]}], "]"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "//", "Transpose"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.684666208299514*^9, 3.684666543712412*^9}, {
   3.684666741842663*^9, 3.684666759515193*^9}, {3.684666874163436*^9, 
   3.6846669720506496`*^9}, {3.684679560520295*^9, 3.6846796414508543`*^9}, {
   3.684679725960309*^9, 3.684679728778064*^9}, {3.684679771550799*^9, 
   3.684679819806808*^9}, {3.684679854937374*^9, 3.684679895714869*^9}, 
   3.684679930914028*^9, {3.684680379803997*^9, 3.684680402744594*^9}, {
   3.684681406859694*^9, 3.684681428618751*^9}, {3.6846815778433647`*^9, 
   3.684681577919108*^9}},ExpressionUUID->"f64ae330-ef38-49e1-a1c0-\
30cb0ea47824"],

Cell["\<\
Here are some results: the frequencies of the male ornamentation trait and \
female choosiness increase slowly over the course of 5000 generations\
\>", "Text",
 CellChangeTimes->{{3.6846831126099157`*^9, 
  3.684683177955166*^9}},ExpressionUUID->"a05bb330-db26-4c68-87bc-\
fc375084a99c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataExact", "=", 
   RowBox[{"simulateExactRecursions", "[", 
    RowBox[{"0.2", ",", "0.2", ",", "0.0", ",", "5000", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", "0.01"}], ",", 
       RowBox[{"a", "\[Rule]", "0.2"}], ",", 
       RowBox[{"\[Mu]", "\[Rule]", "0.005"}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "1"}], ",", 
       RowBox[{"r", "\[Rule]", "0.2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsColumn", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"dataExact", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Orange", ",", 
         RowBox[{"Darker", "[", "Red", "]"}]}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<generation\>\"", ",", "\"\<allele frequency\>\""}], 
        "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"dataExact", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Darker", "[", "Blue", "]"}], "}"}]}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<generation\>\"", ",", "\"\<linkage disequilibrium\>\""}],
         "}"}]}]}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.684666552611364*^9, 3.684666565795759*^9}, {
  3.684666596336494*^9, 3.684666726462476*^9}, {3.6846667662850447`*^9, 
  3.6846668655347147`*^9}, {3.6846669921419153`*^9, 3.684666993045595*^9}, {
  3.684667511853664*^9, 3.684667522461624*^9}, {3.684678954181919*^9, 
  3.684679150215177*^9}, {3.684679359535082*^9, 3.6846794973760853`*^9}, {
  3.684680388253417*^9, 3.684680442664012*^9}, {3.684681903362268*^9, 
  3.68468190758994*^9}, {3.684681976875016*^9, 3.684681985332326*^9}, {
  3.6846820628000183`*^9, 3.68468207306581*^9}, {3.684683793756444*^9, 
  3.684683794260371*^9}},ExpressionUUID->"649b681b-a938-424c-9bc4-\
b1246fcb8adb"],

Cell["\<\
Note that the linkage disequilibrium remains small and that it changes on a \
fast time-scale (recombination is much stronger than selection). \
\>", "Text",
 CellChangeTimes->{{3.684683195070166*^9, 
  3.684683265072543*^9}},ExpressionUUID->"109a32ab-114c-44fa-86c0-\
789b9cc40677"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eq\[CapitalDelta]\[GothicCapitalD]QLE", "[", 
   RowBox[{"p_", ",", "t_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[CapitalDelta]\[GothicCapitalD]", "[", 
       RowBox[{"p", ",", " ", "t", ",", " ", 
        RowBox[{"\[Epsilon]", " ", "\[GothicCapitalD]"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], 
    " ", "//", " ", "Normal"}], " ", "//", " ", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.684667615479189*^9, 3.684667630586474*^9}, {
  3.68468143862728*^9, 3.684681441204114*^9}, {3.684681490263842*^9, 
  3.684681501443852*^9}},ExpressionUUID->"7e5eb44c-a2a9-4182-9111-\
c4e6bcbc25aa"],

Cell["\<\
Using the fact that the linkage disequilibrium is small, we can solve for its \
Quasi-Steady-State equilibrium value: \
\>", "Text",
 CellChangeTimes->{{3.684683307630558*^9, 
  3.684683364444202*^9}},ExpressionUUID->"14481072-6c98-46ec-810a-\
7ce159cd8004"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[GothicCapitalD]QLE", "[", 
   RowBox[{"p_", ",", "t_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "/.", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eq\[CapitalDelta]\[GothicCapitalD]QLE", "[", 
         RowBox[{"p", ",", "t"}], "]"}], "\[Equal]", "0"}], ",", 
       "\[GothicCapitalD]"}], "]"}]}], "//", "First"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.684667633525655*^9, 3.6846676799369717`*^9}, {
  3.684668034896803*^9, 3.684668039435405*^9}, {3.684680096955147*^9, 
  3.684680100155435*^9}, {3.684680623553355*^9, 3.684680636050356*^9}, {
  3.684681461259935*^9, 3.684681461688867*^9}, {3.684681529731566*^9, 
  3.684681531415421*^9}},ExpressionUUID->"ce9fa66f-0ed6-4feb-967f-\
f0c300e489ce"],

Cell[TextData[{
 "The linkage equilibrium is proportional to the genetic variance in trait \
and choosiness, and to the parameter ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "95f7eb05-4e21-402b-a0cd-bd27dcf88487"],
 " which determines the degree of non-random mating"
}], "Text",
 CellChangeTimes->{{3.684683375719247*^9, 3.684683391962461*^9}, {
  3.684683472928749*^9, 
  3.68468351543285*^9}},ExpressionUUID->"b7cd71d8-3353-4721-b15e-\
9ae4ef25bfd7"],

Cell["\<\
The equations for the change in allele frequency simplify as well, if we \
assume weak selection and mutation; in fact, choosiness appears to be neutral \
up to first order approximation\
\>", "Text",
 CellChangeTimes->{{3.684683528889223*^9, 
  3.6846835918636703`*^9}},ExpressionUUID->"4221b59a-3229-47a9-b7af-\
1027625962e7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]p", "[", 
      RowBox[{"p", ",", " ", "t", ",", 
       RowBox[{"\[Epsilon]", " ", "\[GothicCapitalD]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Normal"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]q", "[", 
      RowBox[{"p", ",", " ", "t", ",", " ", 
       RowBox[{"\[Epsilon]", " ", "\[GothicCapitalD]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Normal"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.6846651327717323`*^9, 3.68466518393075*^9}, {
   3.684665254950871*^9, 3.684665309994647*^9}, {3.684665532807605*^9, 
   3.6846655403518133`*^9}, {3.6846670484621058`*^9, 3.684667052321782*^9}, {
   3.684667089693532*^9, 3.68466714750208*^9}, {3.684667200757255*^9, 
   3.684667210039247*^9}, {3.684667285892815*^9, 3.684667293588299*^9}, {
   3.684667378063704*^9, 3.684667380069929*^9}, {3.684667438188273*^9, 
   3.684667438633834*^9}, {3.684667604493875*^9, 3.684667613953719*^9}, {
   3.684668045755178*^9, 3.684668106418755*^9}, {3.684680108720212*^9, 
   3.684680110872858*^9}, {3.6846801592051497`*^9, 3.684680162407852*^9}, {
   3.684681485693407*^9, 3.684681486480178*^9}, 
   3.684683560211433*^9},ExpressionUUID->"4649b547-1442-406f-8e96-\
b6501ea2cac8"],

Cell["\<\
If we look at the second order approximation, we see that choosiness evolves \
as a consequence of indirect selection: the selection response is \
proportional to the strength of selection on the male trait and to the \
linkage disequilibrium between trait and choosiness\
\>", "Text",
 CellChangeTimes->{{3.6846835988424883`*^9, 
  3.6846836737524652`*^9}},ExpressionUUID->"37d845ee-27bf-4372-a5bb-\
b952c66df18d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"\[CapitalDelta]p", "[", 
      RowBox[{"p", ",", " ", "t", ",", " ", 
       RowBox[{"\[Epsilon]", " ", "\[GothicCapitalD]"}]}], "]"}], " ", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", " ", "0", ",", " ", "2"}], "}"}]}], "]"}], 
   " ", "//", " ", "Normal"}], " ", "//", " ", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.684680010705312*^9, 3.684680019888549*^9}, 
   3.684680148926806*^9, {3.6846815384762907`*^9, 
   3.684681538706002*^9}},ExpressionUUID->"cebb9308-3c2c-4626-9e50-\
daa74d748c39"],

Cell["We now end up with a much simpler system:", "Text",
 CellChangeTimes->{{3.684683677595393*^9, 
  3.684683688218439*^9}},ExpressionUUID->"c0c47a03-4b19-4bf9-8fb9-\
dd38ee0e6b82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]tQLE", "[", 
    RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
   RowBox[{"\[Epsilon]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "t"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "p"}], "-", "s"}], ")"}]}], "-", " ", 
      RowBox[{"\[Mu]", " ", "t"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]pQLE", " ", "[", 
    RowBox[{"p_", ",", "t_", ",", "\[GothicCapitalD]_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox["\[Epsilon]", "2"], 
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "p"}], "-", "s"}], ")"}], " ", 
    "\[GothicCapitalD]"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.6846653580290728`*^9, 3.684665465771737*^9}, {
  3.684665570800392*^9, 3.68466563900113*^9}, {3.684665669736697*^9, 
  3.684665769537939*^9}, {3.684665800818556*^9, 3.684665862874728*^9}, {
  3.6846659214084463`*^9, 3.684665928671117*^9}, {3.684667016040751*^9, 
  3.68466703973939*^9}, {3.684667077476923*^9, 3.68466708539359*^9}, {
  3.6846800743256073`*^9, 3.684680084507008*^9}, {3.684680136421164*^9, 
  3.684680138542021*^9}, {3.684680198078788*^9, 3.684680366925683*^9}, {
  3.684680518013199*^9, 3.684680521343822*^9}, {3.684681544256488*^9, 
  3.684681553990967*^9}, {3.6846815893865547`*^9, 
  3.684681589477292*^9}},ExpressionUUID->"99645616-0f0e-4b60-aa16-\
cab18f7ec04c"],

Cell["\<\
The simplified system can be analysed analytically, or by simulation\
\>", "Text",
 CellChangeTimes->{{3.6846837068100758`*^9, 
  3.684683724094829*^9}},ExpressionUUID->"19e3c99c-70fe-4836-be18-\
cc95984ce9d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simulateQLERecursions", "[", 
   RowBox[{"p0_", ",", "t0_", ",", "tEnd_", ",", "pars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "=", "p0"}], ",", 
      RowBox[{"t", "=", "t0"}], ",", "\[GothicCapitalD]", ",", "\[Delta]p", 
      ",", "\[Delta]q", ",", "\[Delta]\[GothicCapitalD]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[GothicCapitalD]", "=", 
            RowBox[{
             RowBox[{"\[GothicCapitalD]QLE", "[", 
              RowBox[{"p", ",", "t"}], "]"}], "/.", "pars"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Sow", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "}"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"\[Delta]p", "=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]pQLE", "[", 
              RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], 
              "]"}], "/.", "pars"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Delta]t", "=", 
            RowBox[{
             RowBox[{"\[CapitalDelta]tQLE", "[", 
              RowBox[{"p", ",", " ", "t", ",", " ", "\[GothicCapitalD]"}], 
              "]"}], "/.", "pars"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p", "+=", " ", "\[Delta]p"}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "+=", " ", "\[Delta]t"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "tEnd"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[GothicCapitalD]", "=", 
         RowBox[{"\[GothicCapitalD]QLE", "[", 
          RowBox[{"p", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{"p", ",", "t", ",", "\[GothicCapitalD]"}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], "//", "Transpose"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.684666208299514*^9, 3.684666543712412*^9}, {
   3.684666741842663*^9, 3.684666759515193*^9}, {3.684666874163436*^9, 
   3.6846669720506496`*^9}, {3.684679560520295*^9, 3.6846796414508543`*^9}, {
   3.684679725960309*^9, 3.684679728778064*^9}, {3.684679771550799*^9, 
   3.684679819806808*^9}, {3.684679854937374*^9, 3.684679895714869*^9}, 
   3.684679930914028*^9, {3.684680379803997*^9, 3.684680402744594*^9}, {
   3.684680486969377*^9, 3.684680488315196*^9}, {3.684680570496992*^9, 
   3.6846806026270437`*^9}, {3.684680669969089*^9, 3.684680750995768*^9}, {
   3.684680957640546*^9, 3.684680973474587*^9}, {3.684681060428227*^9, 
   3.68468106127568*^9}, {3.684681094607522*^9, 3.68468109636117*^9}, {
   3.684681260699836*^9, 3.684681262081909*^9}, {3.684681359108666*^9, 
   3.684681376525016*^9}, {3.6846815958500233`*^9, 
   3.684681652038801*^9}},ExpressionUUID->"6dff7473-9f0c-41b9-b323-\
c3d2e85187fe"],

Cell["\<\
The figure below compares the exact simulations with the approximation for \
weak selection and fast recombination\
\>", "Text",
 CellChangeTimes->{{3.684683746355564*^9, 
  3.6846837837429934`*^9}},ExpressionUUID->"89e90bae-587b-4cd1-87ae-\
5f03ab46e30f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dataQLE", "=", 
   RowBox[{"simulateQLERecursions", "[", 
    RowBox[{"0.2", ",", "0.2", ",", "5000", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", "0.01"}], ",", 
       RowBox[{"a", "\[Rule]", "0.2"}], ",", 
       RowBox[{"\[Mu]", "\[Rule]", "0.005"}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "1"}], ",", 
       RowBox[{"r", "\[Rule]", "0.2"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.684666552611364*^9, 3.684666565795759*^9}, {
   3.684666596336494*^9, 3.684666726462476*^9}, {3.6846667662850447`*^9, 
   3.6846668655347147`*^9}, {3.6846669921419153`*^9, 3.684666993045595*^9}, {
   3.684667511853664*^9, 3.684667522461624*^9}, {3.684678954181919*^9, 
   3.684679150215177*^9}, {3.684679359535082*^9, 3.6846794973760853`*^9}, {
   3.684680388253417*^9, 3.684680442664012*^9}, {3.684680774226125*^9, 
   3.6846807864841423`*^9}, {3.684680838178547*^9, 3.68468088953791*^9}, {
   3.684681013340743*^9, 3.6846810242609243`*^9}, {3.684681133782136*^9, 
   3.6846811466894712`*^9}, {3.6846811806253567`*^9, 3.684681190984314*^9}, {
   3.6846813367076473`*^9, 3.684681338468938*^9}, {3.684681629440825*^9, 
   3.6846816570730963`*^9}, {3.684682147972603*^9, 3.6846821718235683`*^9}, 
   3.684683855028009*^9},ExpressionUUID->"13f3b8d7-ec3f-4d48-9c42-\
d83272bfaa65"],

Cell[BoxData[
 RowBox[{"GraphicsColumn", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", "\n", "   ", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"dataExact", "[", 
         RowBox[{"[", 
          RowBox[{"1", " ", ";;", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"PlotStyle", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"Orange", ",", " ", 
           RowBox[{"Darker", "[", "Red", "]"}]}], "}"}]}], ",", " ", 
        RowBox[{"Joined", " ", "\[Rule]", " ", "True"}], ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<generation\>\"", ",", " ", "\"\<allele frequency\>\""}], 
          "}"}]}]}], "]"}], ",", "\n", "   ", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"dataQLE", "[", 
         RowBox[{"[", 
          RowBox[{"1", " ", ";;", " ", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"PlotStyle", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Dashed", ",", "Orange"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Dashed", ",", 
             RowBox[{"Darker", "[", "Red", "]"}]}], "}"}]}], "}"}]}], ",", 
        " ", 
        RowBox[{"Joined", " ", "\[Rule]", " ", "True"}], ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<generation\>\"", ",", " ", "\"\<allele frequency\>\""}], 
          "}"}]}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"dataExact", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"PlotStyle", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"Darker", "[", "Blue", "]"}], "}"}]}], ",", " ", 
        RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<generation\>\"", ",", " ", "\"\<linkage disequilibrium\>\""}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"dataQLE", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
        RowBox[{"PlotStyle", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{"Dashed", ",", 
           RowBox[{"Darker", "[", "Blue", "]"}]}], "}"}]}], ",", " ", 
        RowBox[{"Joined", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"Frame", " ", "->", " ", "True"}], ",", " ", 
        RowBox[{"FrameLabel", " ", "->", " ", 
         RowBox[{"{", 
          RowBox[{
          "\"\<generation\>\"", ",", " ", "\"\<linkage disequilibrium\>\""}], 
          "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6846811375766993`*^9, 3.684681156817833*^9}, {
  3.6846816772861147`*^9, 3.684681786707076*^9}, {3.6846818702171087`*^9, 
  3.6846818820473022`*^9}},ExpressionUUID->"8c4f9e5e-d855-4f71-8d47-\
87f573ba168e"]
}, Open  ]]
}, Open  ]]
},
NotebookEventActions->{"WindowClose" :> FrontEndExecute[
    FrontEndToken["DeleteGeneratedCells"]]},
WindowSize->{2074, 1231},
WindowMargins->{{213, Automatic}, {1097, Automatic}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.1999999999999, 841.68}},
Magnification:>2. Inherited,
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"Book"}, "Monograph.nb", CharacterEncoding -> 
       "WindowsANSI"]]]}, Visible -> False, FrontEndVersion -> 
  "12.1 for Mac OS X x86 (64-bit) (June 19, 2020)", StyleDefinitions -> 
  "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"4f8c8e00-8545-42c9-96f9-aec152ae5571"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 499, 7, 179, "BookChapterLabel",ExpressionUUID->"712d05a1-22e9-40b4-b2c8-7bb14cf91ee6"],
Cell[1082, 31, 363, 6, 275, "BookChapterTitle",ExpressionUUID->"b0913eb0-414b-4b19-bee1-719825f7d76d"],
Cell[CellGroupData[{
Cell[1470, 41, 236, 4, 81, "Author",ExpressionUUID->"da5d9699-dcd8-4f6c-ab9a-437fb0c4c2f8"],
Cell[1709, 47, 203, 3, 24, "Institution",ExpressionUUID->"2b0dfb21-823c-42d7-ab10-c8b796f19997"],
Cell[1915, 52, 169, 3, 24, "Department",ExpressionUUID->"9c52bd2c-b549-482c-9cf8-ac58f26ed6f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2121, 60, 341, 5, 135, "Section",ExpressionUUID->"1ec99daf-c380-4a7b-afdd-b2dea0c395c5"],
Cell[2465, 67, 658, 15, 58, "Text",ExpressionUUID->"0e1c88aa-cbb5-4959-ab81-63432d1be993"],
Cell[3126, 84, 682, 21, 161, "Input",ExpressionUUID->"41fc4c02-0cd4-4c56-b7ac-5ba00f99e72e"],
Cell[3811, 107, 228, 4, 28, "Text",ExpressionUUID->"a71f0dfd-33ce-44cf-a1a0-24219aa101e9"],
Cell[4042, 113, 410, 10, 28, "Text",ExpressionUUID->"af4bffdc-a776-4766-89dd-ba36d23bcfc2"],
Cell[4455, 125, 449, 11, 28, "Text",ExpressionUUID->"7cca7de0-9e1b-45fc-bf88-8eb8092da686"],
Cell[4907, 138, 430, 10, 28, "Text",ExpressionUUID->"bedd91ec-9653-4ec7-8c64-98d95e7d881b"],
Cell[5340, 150, 429, 10, 28, "Text",ExpressionUUID->"64de78e5-87e2-4466-bd7b-60d6f29cf647"],
Cell[5772, 162, 497, 11, 28, "Text",ExpressionUUID->"e646f763-cdfa-4b00-a656-9400cbe892d1"],
Cell[6272, 175, 290, 5, 28, "Text",ExpressionUUID->"9e1229e9-57ff-4273-9b4e-7c8b590814ce"],
Cell[6565, 182, 542, 13, 28, "Text",ExpressionUUID->"f7fa8a6f-bc7b-4516-94b8-59ddc789e71b"],
Cell[7110, 197, 427, 8, 28, "Text",ExpressionUUID->"04ead36c-ed95-492a-ba36-ed6a67714b22"],
Cell[7540, 207, 760, 19, 32, "Text",ExpressionUUID->"c324d0f6-2cf4-4a59-a838-cbbd5f23cee5"],
Cell[8303, 228, 755, 19, 32, "Text",ExpressionUUID->"df899873-5656-4fc6-bd13-3c980e94e591"],
Cell[9061, 249, 757, 17, 28, "Text",ExpressionUUID->"d6394b8b-4b30-4629-a7fc-4afc5e8f69ca"],
Cell[9821, 268, 497, 9, 28, "Text",ExpressionUUID->"e632081d-d4cd-4a28-93b5-c249e631aa48"],
Cell[10321, 279, 620, 18, 32, "Text",ExpressionUUID->"a5e2b8ed-3c35-4608-9b20-8bcd875035fc"],
Cell[10944, 299, 602, 18, 32, "Text",ExpressionUUID->"28629f72-29d4-4755-b795-5c748733d13e"],
Cell[11549, 319, 625, 18, 32, "Text",ExpressionUUID->"7607770a-f63c-404c-be26-64131123498e"],
Cell[12177, 339, 584, 17, 32, "Text",ExpressionUUID->"fdd4e481-da49-4460-b190-02ed05c25be2"],
Cell[12764, 358, 486, 12, 28, "Text",ExpressionUUID->"b7cadd7b-d8c9-4631-b220-2b00eb568d8a"],
Cell[13253, 372, 71, 0, 28, "Text",ExpressionUUID->"6ec64139-e2fd-45b9-a5a9-7bda8819ae04"],
Cell[13327, 374, 695, 14, 58, "Text",ExpressionUUID->"1136663d-5092-4abc-8c04-f00b06f75a8c"],
Cell[14025, 390, 946, 20, 88, "Text",ExpressionUUID->"5b519826-1e25-4fb8-bebf-3174133cae3c"],
Cell[14974, 412, 1332, 38, 137, "Text",ExpressionUUID->"84f9d75a-e85c-4970-8e84-9eaaf7be1776"],
Cell[16309, 452, 1263, 34, 58, "Text",ExpressionUUID->"fc6d2448-6f06-456b-aacf-cf6f6a132293"],
Cell[17575, 488, 341, 6, 28, "Text",ExpressionUUID->"9c8f7584-8ccf-43f6-9d2b-9e82fad49705"],
Cell[17919, 496, 626, 16, 45, "Text",ExpressionUUID->"6a7a36c5-302b-4f4c-9354-1a9fbf0787d1"],
Cell[18548, 514, 586, 14, 50, "Text",ExpressionUUID->"b996609b-4426-499c-81c9-63b2774e916e"],
Cell[19137, 530, 217, 5, 28, "Text",ExpressionUUID->"9214d177-0858-4494-9216-0eec310a6954"],
Cell[19357, 537, 1157, 30, 94, "Text",ExpressionUUID->"5a78d289-dcff-4a2c-893d-f891a35f606c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20551, 572, 340, 9, 135, "Section",ExpressionUUID->"0ccdd211-acb5-42fe-9c9d-ca4bee80be22"],
Cell[CellGroupData[{
Cell[20916, 585, 213, 4, 69, "Subsection",ExpressionUUID->"e2e53a12-4243-4327-a052-da0b0400d252"],
Cell[21132, 591, 1599, 31, 122, "Text",ExpressionUUID->"a9803371-c5fc-4685-9fbe-8e0e6ad82ffe"],
Cell[22734, 624, 2405, 59, 100, "Input",ExpressionUUID->"81fa9038-5744-4eba-85c7-99797297fded"],
Cell[25142, 685, 1369, 39, 305, "Input",ExpressionUUID->"fbf92283-127f-4bcf-b903-b16f958e984a"],
Cell[26514, 726, 1108, 28, 61, "Input",ExpressionUUID->"46b9cbc7-372c-4504-b2a4-f1a3eb07612a"],
Cell[27625, 756, 4388, 126, 186, "Text",ExpressionUUID->"3d2cbfb5-5de3-41b4-bd0d-9edb8b9d3350"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32050, 887, 271, 3, 69, "Subsection",ExpressionUUID->"bd19d4c6-0dfe-42da-87cb-15fa944b5aab"],
Cell[32324, 892, 813, 17, 28, "Text",ExpressionUUID->"22c8e69a-6f0c-4d53-8520-6bcf4eea598b"],
Cell[33140, 911, 774, 17, 61, "Input",ExpressionUUID->"a52a710c-8c75-4a5c-8b2d-0293671ba3c8"],
Cell[33917, 930, 909, 21, 32, "Text",ExpressionUUID->"79dce08f-eeab-4135-a57e-8f96ac02dc56"],
Cell[34829, 953, 1201, 28, 100, "Input",ExpressionUUID->"3ffc87ee-746e-4eb7-a1ae-490ca4606f09"],
Cell[36033, 983, 988, 23, 32, "Text",ExpressionUUID->"cc737d2a-ffd4-47dd-a80a-a44bfef8f68c"],
Cell[37024, 1008, 623, 12, 28, "Text",ExpressionUUID->"04154973-2baf-43ac-bf85-ebb54788aea9"],
Cell[37650, 1022, 2748, 73, 518, "Input",ExpressionUUID->"ca95aed6-c14c-4d36-85a0-dc88d2ffa2d1"],
Cell[40401, 1097, 416, 7, 61, "Input",ExpressionUUID->"40e5fffd-6cce-4ae1-9e2b-a2057a5a6496"],
Cell[40820, 1106, 543, 16, 28, "Text",ExpressionUUID->"8a6134ee-20dc-4811-8999-697322d0d255"],
Cell[41366, 1124, 1214, 19, 28, "Text",ExpressionUUID->"f9b9b60a-5190-46a3-b414-ec443ceeb5d7"],
Cell[42583, 1145, 2021, 41, 65, "Text",ExpressionUUID->"bc70e212-4c22-4d79-8cff-4e6ff666582f"],
Cell[44607, 1188, 466, 8, 61, "Input",ExpressionUUID->"52fd9de7-de58-4efd-ab03-a58f3eec38e8"],
Cell[45076, 1198, 466, 8, 61, "Input",ExpressionUUID->"2c39e535-14b1-4565-af9e-5105117ea28f"],
Cell[45545, 1208, 565, 14, 28, "Text",ExpressionUUID->"e993298b-4a9b-456a-be46-2554551069d3"],
Cell[46113, 1224, 1713, 28, 28, "Text",ExpressionUUID->"fcb4adbb-5e95-4111-bbd8-a4697d92b0e6"],
Cell[47829, 1254, 674, 18, 28, "Text",ExpressionUUID->"84a05020-8f8b-4c0a-b7e1-738e99676023"],
Cell[48506, 1274, 559, 9, 61, "Input",ExpressionUUID->"35a4de09-c384-407d-b640-3b2c54770bd7"],
Cell[49068, 1285, 562, 9, 61, "Input",ExpressionUUID->"ab8d7851-cad4-4120-aa61-6e1181b8f303"],
Cell[49633, 1296, 1455, 21, 28, "Text",ExpressionUUID->"dc37668f-08e0-4abe-9914-83e6430fdb13"],
Cell[51091, 1319, 1939, 31, 58, "Text",ExpressionUUID->"db8cd0e2-59d1-44d5-8ed3-4b0bd88a6afb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53067, 1355, 222, 4, 69, "Subsection",ExpressionUUID->"3b3a750d-5eed-4ae9-b37c-46435bf90c42"],
Cell[53292, 1361, 805, 15, 58, "Text",ExpressionUUID->"6c86bc52-fdee-4c92-830d-7ace09dc1bee"],
Cell[54100, 1378, 12835, 288, 1278, "Input",ExpressionUUID->"367203c3-faec-448c-885d-d5e9206e20ef"],
Cell[66938, 1668, 866, 18, 28, "Text",ExpressionUUID->"94a6db3c-68fa-455a-8d48-a40a56b4b37e"],
Cell[67807, 1688, 1634, 41, 100, "Input",ExpressionUUID->"58742ff3-e9d9-4a81-93ff-a24a78e75d48"],
Cell[69444, 1731, 2083, 30, 58, "Text",ExpressionUUID->"192b17ef-61c8-4beb-8a3b-350599268214"],
Cell[71530, 1763, 1540, 26, 58, "Text",ExpressionUUID->"3df9a6a1-32d7-490e-8f42-33b660ec8fa4"],
Cell[73073, 1791, 1500, 21, 58, "Text",ExpressionUUID->"28c755b0-fc56-4751-abd0-3a7ed1895a4a"],
Cell[74576, 1814, 142, 3, 28, "Text",ExpressionUUID->"f84f13bb-0aa9-4557-9eed-7ec9c4aaeb0a"],
Cell[74721, 1819, 71, 0, 28, "Text",ExpressionUUID->"ea573964-64fe-4ed3-aa2b-a3538258f1b1"],
Cell[74795, 1821, 534, 12, 58, "Text",ExpressionUUID->"eb933df1-1934-4e72-886d-5920ba6a6355"],
Cell[75332, 1835, 1022, 26, 61, "Input",ExpressionUUID->"4017a5e6-1176-4929-b4e7-a001feaebcd1"],
Cell[76357, 1863, 2083, 30, 58, "Text",ExpressionUUID->"2731d20e-385f-4af8-879b-09523096e2dd"],
Cell[78443, 1895, 1931, 34, 58, "Text",ExpressionUUID->"67c9717e-070a-4c6b-b196-4c77ef20e656"],
Cell[80377, 1931, 1668, 25, 58, "Text",ExpressionUUID->"12643bff-ca5f-416d-83bc-9f9f535496dd"],
Cell[82048, 1958, 585, 9, 61, "Input",ExpressionUUID->"2e98a212-2661-4445-9105-6d6a7dc5212b"],
Cell[82636, 1969, 454, 9, 58, "Text",ExpressionUUID->"403dd133-0b6a-4bdd-be83-ea9d68032be5"],
Cell[83093, 1980, 816, 17, 61, "Input",ExpressionUUID->"17dea889-274a-4ca3-9237-441f93bf1b55"],
Cell[83912, 1999, 315, 7, 28, "Text",ExpressionUUID->"11291e5d-a28f-42d6-abd7-343e92e5736f"],
Cell[84230, 2008, 144, 3, 28, "Text",ExpressionUUID->"a4229f7b-91c2-4542-8407-5a65d6551278"],
Cell[84377, 2013, 1861, 33, 28, "Text",ExpressionUUID->"58d44244-5a10-4722-9e53-c8d9ef9789ca"],
Cell[86241, 2048, 2098, 33, 58, "Text",ExpressionUUID->"afb481a6-150e-4581-b73c-198bad115cdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88376, 2086, 234, 4, 69, "Subsection",ExpressionUUID->"95355126-a2d6-4a8f-b8c2-0ab8c8811150"],
Cell[88613, 2092, 1282, 27, 126, "Text",ExpressionUUID->"ae00f494-656f-48ee-8fcc-edf0541de71a"],
Cell[89898, 2121, 8803, 195, 1088, "Input",ExpressionUUID->"7e130394-b910-4999-a19c-4617bb8e53cf"],
Cell[98704, 2318, 1052, 20, 92, "Text",ExpressionUUID->"f75c34f0-109b-4bbb-8b89-d6ca844ce441"],
Cell[99759, 2340, 1374, 32, 138, "Input",ExpressionUUID->"a706f0f5-8490-48e9-a2b5-b24df676ba27"],
Cell[101136, 2374, 2492, 43, 88, "Text",ExpressionUUID->"708a48e1-85ce-45df-a8d5-c0b356493cb5"],
Cell[103631, 2419, 542, 10, 58, "Text",ExpressionUUID->"0e1fb298-fb86-4bec-afda-82b9e9ada9eb"],
Cell[104176, 2431, 968, 21, 61, "Input",ExpressionUUID->"4fce2dc3-695c-4e06-a77a-29302ea7d577"],
Cell[105147, 2454, 451, 9, 58, "Text",ExpressionUUID->"9833edc6-c413-4e47-8a8f-7187504553e7"],
Cell[105601, 2465, 902, 18, 61, "Input",ExpressionUUID->"13725003-932a-4720-bbb9-6bc3075c39f2"],
Cell[106506, 2485, 2656, 43, 88, "Text",ExpressionUUID->"51cb92fd-2079-4e7d-8971-76a7e7c308df"],
Cell[109165, 2530, 1968, 28, 28, "Text",ExpressionUUID->"e128b008-efd3-451a-a8d6-c30d951abda7"],
Cell[111136, 2560, 906, 18, 32, "Text",ExpressionUUID->"a03d1aea-048c-4652-bb1c-9be1dfff53f8"],
Cell[112045, 2580, 1191, 26, 100, "Input",ExpressionUUID->"63c6a7ed-f798-4b41-9aa3-acb63944138f"],
Cell[113239, 2608, 634, 17, 62, "Text",ExpressionUUID->"32fa0bc6-41a8-4136-b631-1fd3e1022beb"],
Cell[113876, 2627, 407, 11, 61, "Input",ExpressionUUID->"a2a05124-74ce-4591-8566-15c690b39bd2"],
Cell[114286, 2640, 2567, 44, 33, "Text",ExpressionUUID->"cad3c23d-1ec8-4890-a558-47acc68fc755"],
Cell[116856, 2686, 142, 3, 28, "Text",ExpressionUUID->"c8e30835-8def-4a55-9bfd-9c5f949d3441"],
Cell[117001, 2691, 434, 8, 58, "Text",ExpressionUUID->"3e511f64-fb91-4762-96a0-1eabde34d8ed"],
Cell[117438, 2701, 2120, 30, 28, "Text",ExpressionUUID->"08032575-026a-4dd3-948c-31bb603c5a86"],
Cell[119561, 2733, 3104, 54, 98, "Text",ExpressionUUID->"b0f64498-b6f2-417b-b1d0-8ef748f0bd51"],
Cell[122668, 2789, 4061, 80, 138, "Text",ExpressionUUID->"71740803-bbf3-4cfd-b212-282d78b2a31d"],
Cell[126732, 2871, 1498, 41, 108, "Text",ExpressionUUID->"e623e4dd-8a88-42d6-820a-2531957ecf9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128267, 2917, 274, 4, 69, "Subsection",ExpressionUUID->"4439671e-443a-493e-afb5-33e9c43d4f3c"],
Cell[128544, 2923, 970, 23, 66, "Text",ExpressionUUID->"e7029cdf-c7e0-4e62-a8b4-ca1655b5d0a2"],
Cell[129517, 2948, 783, 20, 61, "Input",ExpressionUUID->"a9e8c1e2-7be8-4567-bccc-5fcbfe6c3beb"],
Cell[130303, 2970, 699, 18, 62, "Text",ExpressionUUID->"e14147ba-eb2e-40b6-b371-97e94e1780e2"],
Cell[131005, 2990, 4403, 104, 328, "Input",ExpressionUUID->"eea438ff-2ef3-4415-8552-667bb954fc8b"],
Cell[135411, 3096, 753, 16, 92, "Text",ExpressionUUID->"37a1457d-9efe-43c1-8c49-4975cfae2c08"],
Cell[136167, 3114, 2163, 52, 404, "Input",ExpressionUUID->"3fa9ab7b-0e03-4fd7-8537-5eb4eb8e1a55"],
Cell[138333, 3168, 939, 19, 58, "Text",ExpressionUUID->"89e7a805-de3d-4043-a654-02f39bbb7ec4"],
Cell[139275, 3189, 469, 9, 58, "Text",ExpressionUUID->"c0a13cf7-6e95-4f7f-b621-49d573fb6b4d"],
Cell[139747, 3200, 538, 10, 28, "Text",ExpressionUUID->"438a33e9-6d93-447d-b2bd-a6616830039f"],
Cell[140288, 3212, 914, 18, 58, "Text",ExpressionUUID->"c18bfdec-aeec-4374-9eae-4036a7a0a688"],
Cell[141205, 3232, 376, 7, 58, "Text",ExpressionUUID->"3c0cf358-29b4-4a7a-ba3b-03ca084f475e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[141630, 3245, 477, 8, 135, "Section",ExpressionUUID->"5f1b1aad-2420-414b-a14b-c0f542f83ec0"],
Cell[142110, 3255, 1674, 55, 58, "Text",ExpressionUUID->"324a626a-0d9a-47f8-be4e-bf3c1b8da321"],
Cell[143787, 3312, 1065, 28, 61, "Input",ExpressionUUID->"08d5d68f-a833-4742-8577-979a9d112a7e"],
Cell[144855, 3342, 687, 21, 28, "Text",ExpressionUUID->"76a26cc4-729f-4b8a-8a6c-ee73b56e752c"],
Cell[145545, 3365, 1348, 33, 135, "Input",ExpressionUUID->"d199f108-abab-46c6-9ec1-02f2c0fb8272"],
Cell[146896, 3400, 890, 27, 28, "Text",ExpressionUUID->"a506a725-6d6d-413d-9833-84e0d8e5d732"],
Cell[147789, 3429, 908, 27, 135, "Input",ExpressionUUID->"9ea0fcb3-1976-4973-9bf1-61638e0f3047"],
Cell[148700, 3458, 722, 18, 58, "Text",ExpressionUUID->"07dba236-a3b2-4d88-8e4f-eb639827d8fc"],
Cell[149425, 3478, 3096, 85, 681, "Input",ExpressionUUID->"732f8ae6-18df-4e27-be2a-4c5b9e734efb"],
Cell[152524, 3565, 474, 12, 28, "Text",ExpressionUUID->"f0c7ecc8-b0ca-484c-bcad-88b5886be649"],
Cell[153001, 3579, 870, 25, 61, "Input",ExpressionUUID->"31f384b8-31a0-4b05-a503-dd77a5bb86e9"],
Cell[153874, 3606, 217, 5, 28, "Text",ExpressionUUID->"95cada58-12c1-4517-8ca3-0cfa9bba1402"],
Cell[154094, 3613, 1919, 44, 138, "Input",ExpressionUUID->"e41c83b3-af97-4391-beb8-37d74f8b380a"],
Cell[156016, 3659, 243, 6, 28, "Text",ExpressionUUID->"6bd88db4-ce28-4ae8-833f-6a8245eb9c69"],
Cell[156262, 3667, 2134, 56, 138, "Input",ExpressionUUID->"5788d85c-58c3-4b2c-a039-5b40b0531f2f"],
Cell[158399, 3725, 387, 8, 58, "Text",ExpressionUUID->"593d7457-488a-491e-aab7-a9172c94ae9a"],
Cell[158789, 3735, 1264, 29, 138, "Input",ExpressionUUID->"6908e182-2ad8-4203-b656-474ec02301c5"],
Cell[160056, 3766, 251, 4, 28, "Text",ExpressionUUID->"6add6505-9073-4085-8d60-5a8935c0ce38"],
Cell[160310, 3772, 1175, 30, 138, "Input",ExpressionUUID->"58bfcb52-4d8d-46eb-b0c1-a78aa3296a6d"],
Cell[161488, 3804, 190, 3, 28, "Text",ExpressionUUID->"67217a8e-9c36-4956-890b-c6c402134056"],
Cell[161681, 3809, 2912, 62, 518, "Input",ExpressionUUID->"f64ae330-ef38-49e1-a1c0-30cb0ea47824"],
Cell[164596, 3873, 298, 6, 28, "Text",ExpressionUUID->"a05bb330-db26-4c68-87bc-fc375084a99c"],
Cell[164897, 3881, 2366, 53, 252, "Input",ExpressionUUID->"649b681b-a938-424c-9bc4-b1246fcb8adb"],
Cell[167266, 3936, 293, 6, 28, "Text",ExpressionUUID->"109a32ab-114c-44fa-86c0-789b9cc40677"],
Cell[167562, 3944, 764, 17, 61, "Input",ExpressionUUID->"7e5eb44c-a2a9-4182-9111-c4e6bcbc25aa"],
Cell[168329, 3963, 268, 6, 28, "Text",ExpressionUUID->"14481072-6c98-46ec-810a-7ce159cd8004"],
Cell[168600, 3971, 816, 19, 61, "Input",ExpressionUUID->"ce9fa66f-0ed6-4feb-967f-f0c300e489ce"],
Cell[169419, 3992, 479, 11, 28, "Text",ExpressionUUID->"b7cd71d8-3353-4721-b15e-9ae4ef25bfd7"],
Cell[169901, 4005, 338, 7, 58, "Text",ExpressionUUID->"4221b59a-3229-47a9-b7af-1027625962e7"],
Cell[170242, 4014, 1529, 32, 100, "Input",ExpressionUUID->"4649b547-1442-406f-8e96-b6501ea2cac8"],
Cell[171774, 4048, 425, 8, 58, "Text",ExpressionUUID->"37d845ee-27bf-4372-a5bb-b952c66df18d"],
Cell[172202, 4058, 618, 15, 61, "Input",ExpressionUUID->"cebb9308-3c2c-4626-9e50-daa74d748c39"],
Cell[172823, 4075, 183, 3, 28, "Text",ExpressionUUID->"c0c47a03-4b19-4bf9-8fb9-dd38ee0e6b82"],
Cell[173009, 4080, 1581, 37, 158, "Input",ExpressionUUID->"99645616-0f0e-4b60-aa16-cab18f7ec04c"],
Cell[174593, 4119, 220, 5, 28, "Text",ExpressionUUID->"19e3c99c-70fe-4836-be18-cc95984ce9d6"],
Cell[174816, 4126, 3225, 67, 556, "Input",ExpressionUUID->"6dff7473-9f0c-41b9-b323-c3d2e85187fe"],
Cell[178044, 4195, 266, 6, 28, "Text",ExpressionUUID->"89e90bae-587b-4cd1-87ae-5f03ab46e30f"],
Cell[178313, 4203, 1351, 24, 61, "Input",ExpressionUUID->"13f3b8d7-ec3f-4d48-9c42-d83272bfaa65"],
Cell[179667, 4229, 3247, 78, 442, "Input",ExpressionUUID->"8c4f9e5e-d855-4f71-8d47-87f573ba168e"]
}, Open  ]]
}, Open  ]]
}
]
*)

